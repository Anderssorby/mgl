2014-10-16 13:59:04: TRAIN-MNIST/1 :DROPOUTP NIL
2014-10-16 13:59:04: init: #<FULL-CLOUD (INPUTS F1) :NORM 6.25386d+0> 0.1
2014-10-16 13:59:04: init: #<FULL-CLOUD (F1 F2) :NORM 4.99276d+0> 0.1
2014-10-16 13:59:04: init: #<FULL-CLOUD (F2 F3) :NORM 1.00118d+1> 0.1
2014-10-16 13:59:04: Starting to train level 0 RBM in DBN.
2014-10-16 13:59:04: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {1003ADE203}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM (C0 INPUTS) - (C1 F1)>
  MONITORS                   = (#<MONITOR train train+ rbm INPUTS rmse: 0.000e+0 (0)>)
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = NIL
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 1
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {1003A100D3}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = NIL
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 1

#<MNIST-RBM {1048D20B93}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C0 1(1/100)>
                    #<SIGMOID-CHUNK INPUTS 784(1/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C1 1(1/100)>
                   #<SIGMOID-CHUNK F1 500(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>
            #<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>
            #<FULL-CLOUD (INPUTS F1) :NORM 6.25445d+1>)
  N-STRIPES = 1
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN/1 {1026E1C213}>

2014-10-16 13:59:04: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {1003A100D3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d+1>)
                    {1003D16093}>
                  {1003D15043}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>)
                    {1003D15903}>
                  {1003D14F53}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)
                    {1003D15133}>
                  {1003D14E63}>)
  SEGMENTS = (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d+1>
              #<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>
              #<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {1003D15043}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d+1>)
                  {1003D16093}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {1003D14F53}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>)
                  {1003D15903}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {1003D14E63}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)
                  {1003D15133}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 13:59:04: cuda mats: 28, copies: h->d: 0, d->h: 3
2014-10-16 13:59:04: test at n-instances: 0
2014-10-16 13:59:06: pred. test+ dbn l0, rbm INPUTS rmse: 5.215d-1 (7840000)
2014-10-16 13:59:06: cuda mats: 10034, copies: h->d: 10000, d->h: 3
2014-10-16 13:59:06: ---------------------------------------------------
2014-10-16 13:59:24: training at n-instances: 60000
2014-10-16 13:59:24: train train+ rbm INPUTS rmse: 1.382d-1 (47040000)
2014-10-16 13:59:24: test at n-instances: 60000
2014-10-16 13:59:25: pred. test+ dbn l0, rbm INPUTS rmse: 8.175d-2 (7840000)
2014-10-16 13:59:25: cuda mats: 70041, copies: h->d: 70000, d->h: 3
2014-10-16 13:59:25: ---------------------------------------------------
2014-10-16 13:59:41: training at n-instances: 120000
2014-10-16 13:59:41: train train+ rbm INPUTS rmse: 1.084d-1 (47040000)
2014-10-16 13:59:41: test at n-instances: 120000
2014-10-16 13:59:43: pred. test+ dbn l0, rbm INPUTS rmse: 6.940d-2 (7840000)
2014-10-16 13:59:43: cuda mats: 70041, copies: h->d: 70000, d->h: 3
2014-10-16 13:59:43: ---------------------------------------------------
2014-10-16 13:59:43: Starting to train level 1 RBM in DBN.
2014-10-16 13:59:43: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {104076F353}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM (C1 F1) - (C2 F2)>
  MONITORS                   = (#<MONITOR train train+ rbm F1 rmse: 0.000e+0 (0)>)
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = NIL
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 1
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {104076E783}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = NIL
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 1

#<MNIST-RBM {1048D20BB3}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C1 1(100/100)>
                    #<SIGMOID-CHUNK F1 500(100/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C2 1(1/100)>
                   #<SIGMOID-CHUNK F2 500(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>
            #<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>
            #<FULL-CLOUD (F1 F2) :NORM 5.00045d+1>)
  N-STRIPES = 100
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN/1 {1026E1C213}>

2014-10-16 13:59:43: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {104076E783}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 F2) :NORM 5.00045d+1>)
                    {1040770D43}>
                  {104076FCD3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>)
                    {10407705B3}>
                  {104076FBE3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)
                    {104076FDC3}>
                  {104076FAF3}>)
  SEGMENTS = (#<FULL-CLOUD (F1 F2) :NORM 5.00045d+1>
              #<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>
              #<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {104076FCD3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 F2) :NORM 5.00045d+1>)
                  {1040770D43}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {104076FBE3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>)
                  {10407705B3}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {104076FAF3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)
                  {104076FDC3}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 13:59:43: cuda mats: 70041, copies: h->d: 70000, d->h: 6
2014-10-16 13:59:43: test at n-instances: 0
2014-10-16 13:59:45: pred. test+ dbn l0, rbm INPUTS rmse: 3.194d-1 (7840000)
2014-10-16 13:59:45: pred. test+ dbn l1, rbm F1     rmse: 4.153d-1 (5000000)
2014-10-16 13:59:45: cuda mats: 70047, copies: h->d: 70000, d->h: 6
2014-10-16 13:59:45: ---------------------------------------------------
2014-10-16 13:59:59: training at n-instances: 60000
2014-10-16 13:59:59: train train+ rbm F1 rmse: 1.791d-1 (30000000)
2014-10-16 13:59:59: test at n-instances: 60000
2014-10-16 14:00:01: pred. test+ dbn l0, rbm INPUTS rmse: 9.856d-2 (7840000)
2014-10-16 14:00:01: pred. test+ dbn l1, rbm F1     rmse: 9.226d-2 (5000000)
2014-10-16 14:00:01: cuda mats: 70054, copies: h->d: 70000, d->h: 6
2014-10-16 14:00:01: ---------------------------------------------------
2014-10-16 14:00:15: training at n-instances: 120000
2014-10-16 14:00:15: train train+ rbm F1 rmse: 1.449d-1 (30000000)
2014-10-16 14:00:15: test at n-instances: 120000
2014-10-16 14:00:17: pred. test+ dbn l0, rbm INPUTS rmse: 9.599d-2 (7840000)
2014-10-16 14:00:17: pred. test+ dbn l1, rbm F1     rmse: 8.186d-2 (5000000)
2014-10-16 14:00:17: cuda mats: 70051, copies: h->d: 70000, d->h: 6
2014-10-16 14:00:17: ---------------------------------------------------
2014-10-16 14:00:17: Starting to train level 2 RBM in DBN.
2014-10-16 14:00:17: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {1005242C33}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM (C2 F2) - (C3 F3)>
  MONITORS                   = (#<MONITOR train train+ rbm F2 rmse: 0.000e+0 (0)>)
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = NIL
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 1
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {1005242063}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = NIL
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 1

#<MNIST-RBM {1048D20BD3}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C2 1(100/100)>
                    #<SIGMOID-CHUNK F2 500(100/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C3 1(1/100)>
                   #<SIGMOID-CHUNK F3 2000(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C2 F3) :NORM 0.00000d+0>
            #<FULL-CLOUD (F2 C3) :NORM 0.00000d+0>
            #<FULL-CLOUD (F2 F3) :NORM 9.98857d+1>)
  N-STRIPES = 100
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN/1 {1026E1C213}>

2014-10-16 14:00:17: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {1005242063}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F2 F3) :NORM 9.98857d+1>)
                    {10052443D3}>
                  {10052433C3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F2 C3) :NORM 0.00000d+0>)
                    {1005243C43}>
                  {10052432D3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C2 F3) :NORM 0.00000d+0>)
                    {10052434B3}>
                  {10052431E3}>)
  SEGMENTS = (#<FULL-CLOUD (F2 F3) :NORM 9.98857d+1>
              #<FULL-CLOUD (F2 C3) :NORM 0.00000d+0>
              #<FULL-CLOUD (C2 F3) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {10052433C3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F2 F3) :NORM 9.98857d+1>)
                  {10052443D3}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {10052432D3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F2 C3) :NORM 0.00000d+0>)
                  {1005243C43}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {10052431E3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C2 F3) :NORM 0.00000d+0>)
                  {10052434B3}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:00:17: cuda mats: 70051, copies: h->d: 70000, d->h: 9
2014-10-16 14:00:17: test at n-instances: 0
2014-10-16 14:00:21: pred. test+ dbn l0, rbm INPUTS rmse: 2.974d-1 (7840000)
2014-10-16 14:00:21: pred. test+ dbn l1, rbm F1     rmse: 4.073d-1 (5000000)
2014-10-16 14:00:21: pred. test+ dbn l2, rbm F2     rmse: 5.084d-1 (5000000)
2014-10-16 14:00:21: cuda mats: 70057, copies: h->d: 70000, d->h: 9
2014-10-16 14:00:21: ---------------------------------------------------
2014-10-16 14:01:06: training at n-instances: 60000
2014-10-16 14:01:06: train train+ rbm F2 rmse: 1.504d-1 (30000000)
2014-10-16 14:01:06: test at n-instances: 60000
2014-10-16 14:01:11: pred. test+ dbn l0, rbm INPUTS rmse: 1.116d-1 (7840000)
2014-10-16 14:01:11: pred. test+ dbn l1, rbm F1     rmse: 1.106d-1 (5000000)
2014-10-16 14:01:11: pred. test+ dbn l2, rbm F2     rmse: 6.187d-2 (5000000)
2014-10-16 14:01:11: cuda mats: 70064, copies: h->d: 70000, d->h: 9
2014-10-16 14:01:11: ---------------------------------------------------
2014-10-16 14:01:56: training at n-instances: 120000
2014-10-16 14:01:56: train train+ rbm F2 rmse: 1.249d-1 (30000000)
2014-10-16 14:01:56: test at n-instances: 120000
2014-10-16 14:02:01: pred. test+ dbn l0, rbm INPUTS rmse: 1.108d-1 (7840000)
2014-10-16 14:02:01: pred. test+ dbn l1, rbm F1     rmse: 1.082d-1 (5000000)
2014-10-16 14:02:01: pred. test+ dbn l2, rbm F2     rmse: 5.623d-2 (5000000)
2014-10-16 14:02:01: cuda mats: 70064, copies: h->d: 70000, d->h: 9
2014-10-16 14:02:01: ---------------------------------------------------
2014-10-16 14:02:01: bpn inits:
((:CLOUD-NAME (C2 F3) :WEIGHT-NAME (:CLOUD (C2 F3)))
 (:CLOUD-NAME (F2 F3) :WEIGHT-NAME (:CLOUD (F2 F3)))
 (:CLOUD-NAME (C1 F2) :WEIGHT-NAME (:CLOUD (C1 F2)))
 (:CLOUD-NAME (F1 F2) :WEIGHT-NAME (:CLOUD (F1 F2)))
 (:CLOUD-NAME (C0 F1) :WEIGHT-NAME (:CLOUD (C0 F1)))
 (:CLOUD-NAME (INPUTS F1) :WEIGHT-NAME (:CLOUD (INPUTS F1))))
2014-10-16 14:02:01: bpn def:
(BUILD-BPN (:CLASS 'MNIST-BPN :MAX-N-STRIPES 1000 :INITARGS 'NIL)
  (#:G49174 (->INPUT :NAME '(:CHUNK INPUTS) :SIZE 784))
  (#:G49173 (->CONSTANT :NAME '(:CHUNK C0) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G49178 (->WEIGHT :NAME '(:CLOUD (INPUTS F1)) :SIZE 392000))
  (#:G49179
   (->ACTIVATION :NAME '(:CLOUD (INPUTS F1) :LINEAR) :SIZE 500 :WEIGHTS
                 #:G49178 :X #:G49174 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G49180 (->WEIGHT :NAME '(:CLOUD (C0 F1)) :SIZE 500))
  (#:G49181
   (->ACTIVATION :NAME '(:CLOUD (C0 F1) :LINEAR) :SIZE 500 :WEIGHTS #:G49180 :X
                 #:G49173 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G49177 (->+ :NAME '(:CHUNK F1 :ACTIVATION) :ARGS (LIST #:G49179 #:G49181)))
  (#:G49172 (->SIGMOID :NAME '(:CHUNK F1) :X #:G49177))
  (#:G49171 (->CONSTANT :NAME '(:CHUNK C1) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G49192 (->WEIGHT :NAME '(:CLOUD (F1 F2)) :SIZE 250000))
  (#:G49193
   (->ACTIVATION :NAME '(:CLOUD (F1 F2) :LINEAR) :SIZE 500 :WEIGHTS #:G49192 :X
                 #:G49172 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G49194 (->WEIGHT :NAME '(:CLOUD (C1 F2)) :SIZE 500))
  (#:G49195
   (->ACTIVATION :NAME '(:CLOUD (C1 F2) :LINEAR) :SIZE 500 :WEIGHTS #:G49194 :X
                 #:G49171 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G49191 (->+ :NAME '(:CHUNK F2 :ACTIVATION) :ARGS (LIST #:G49193 #:G49195)))
  (#:G49170 (->SIGMOID :NAME '(:CHUNK F2) :X #:G49191))
  (#:G49168 (->CONSTANT :NAME '(:CHUNK C2) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G49198 (->WEIGHT :NAME '(:CLOUD (F2 F3)) :SIZE 1000000))
  (#:G49199
   (->ACTIVATION :NAME '(:CLOUD (F2 F3) :LINEAR) :SIZE 2000 :WEIGHTS #:G49198
                 :X #:G49170 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G49200 (->WEIGHT :NAME '(:CLOUD (C2 F3)) :SIZE 2000))
  (#:G49201
   (->ACTIVATION :NAME '(:CLOUD (C2 F3) :LINEAR) :SIZE 2000 :WEIGHTS #:G49200
                 :X #:G49168 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G49197 (->+ :NAME '(:CHUNK F3 :ACTIVATION) :ARGS (LIST #:G49199 #:G49201)))
  (#:G49169 (->SIGMOID :NAME '(:CHUNK F3) :X #:G49197)))
2014-10-16 14:02:01: Starting to train the softmax layer of BPN
2014-10-16 14:02:01: Describing gradient source:
#<BP-LEARNER {100C711C53}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 1000 {1004676B83}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = NIL

BP-LEARNER description:
  BPN = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 1000 {1004676B83}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN {1004676B83}>
BPN description:
  LUMPS = #(#<->INPUT (:CHUNK INPUTS) :SIZE
              784*1(1/1000) :norm 0.00000>
            #<->CONSTANT (:CHUNK C0) :SIZE 1*1(1/1000) :norm 1.00000>
            #<->WEIGHT (:CLOUD #1=(INPUTS F1)) :SIZE
              392000*1(1/1) :norm 99.85369>
            #<->ACTIVATION (:CLOUD #1# . #2=(:LINEAR)) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:CLOUD #3=(C0 F1)) :SIZE
              500*1(1/1) :norm 28.44436>
            #<->ACTIVATION (:CLOUD #3# . #2#) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->+ (:CHUNK F1 . #4=(:ACTIVATION)) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->SIGMOID (:CHUNK F1) :SIZE 500*1(1/1000) :norm 0.00000>
            #<->CONSTANT (:CHUNK C1) :SIZE 1*1(1/1000) :norm 1.00000>
            #<->WEIGHT (:CLOUD #5=(F1 F2)) :SIZE
              250000*1(1/1) :norm 71.69626>
            #<->ACTIVATION (:CLOUD #5# . #2#) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:CLOUD #6=(C1 F2)) :SIZE
              500*1(1/1) :norm 4.61589>
            #<->ACTIVATION (:CLOUD #6# . #2#) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->+ (:CHUNK F2 . #4#) :SIZE 500*1(1/1000) :norm 0.00000>
            #<->SIGMOID (:CHUNK F2) :SIZE 500*1(1/1000) :norm 0.00000>
            #<->CONSTANT (:CHUNK C2) :SIZE 1*1(1/1000) :norm 1.00000>
            #<->WEIGHT (:CLOUD #7=(F2 F3)) :SIZE
              1000000*1(1/1) :norm 115.95142>
            #<->ACTIVATION (:CLOUD #7# . #2#) :SIZE
              2000*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:CLOUD #8=(C2 F3)) :SIZE
              2000*1(1/1) :norm 5.88131>
            #<->ACTIVATION (:CLOUD #8# . #2#) :SIZE
              2000*1(1/1000) :norm 0.00000>
            #<->+ (:CHUNK F3 . #4#) :SIZE 2000*1(1/1000) :norm 0.00000>
            #<->SIGMOID #9=(:CHUNK F3) :SIZE
              2000*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.28631>
            #<->WEIGHT #10=(#9# PREDICTIONS) :SIZE
              20000*1(1/1) :norm 13.98526>
            #<->ACTIVATION (#10# :ACTIVATION) :SIZE
              10*1(1/1000) :norm 0.00000>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1(1/1000) :norm 0.00000>
            #<->INPUT EXPECTATIONS :SIZE 10*1(1/1000) :norm 0.00000>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1(1/1000) :norm 0.00000>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1(1/1000) :norm 0.00000>)
  N-STRIPES = 1
  MAX-N-STRIPES = 1000
2014-10-16 14:02:01: Describing optimizer:
#<MNIST-CG-BP-OPTIMIZER {100C694933}>
CG-OPTIMIZER description:
  N-INSTANCES = 0
  BATCH-SIZE = 1000
  CG-ARGS = (:MAX-N-LINE-SEARCHES 3)
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.28631>
                   #<->WEIGHT ((:CHUNK F3) PREDICTIONS) :SIZE
                     20000*1(1/1) :norm 13.98526>)
                  {100C713613}>
2014-10-16 14:02:01: cuda mats: 15, copies: h->d: 6, d->h: 8
2014-10-16 14:02:01: test at n-instances: 0
2014-10-16 14:02:04: pred. test bpn PREDICTIONS acc.: 10.37% (10000)
2014-10-16 14:02:04: pred. test bpn PREDICTIONS xent: 2.883d-3 (10000)
2014-10-16 14:02:04: cuda mats: 10038, copies: h->d: 10027, d->h: 28
2014-10-16 14:02:04: ---------------------------------------------------
2014-10-16 14:02:06: n-instances: 0
2014-10-16 14:02:06: best-f: 9.20470d+2 (1000), n-evaluations: 12
2014-10-16 14:02:06: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:09: n-instances: 1000
2014-10-16 14:02:09: best-f: 5.53008d+2 (1000), n-evaluations: 13
2014-10-16 14:02:09: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:11: n-instances: 2000
2014-10-16 14:02:11: best-f: 4.39275d+2 (1000), n-evaluations: 10
2014-10-16 14:02:11: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:13: n-instances: 3000
2014-10-16 14:02:13: best-f: 3.59874d+2 (1000), n-evaluations: 11
2014-10-16 14:02:13: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:16: n-instances: 4000
2014-10-16 14:02:16: best-f: 3.67289d+2 (1000), n-evaluations: 11
2014-10-16 14:02:16: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:18: n-instances: 5000
2014-10-16 14:02:18: best-f: 3.09878d+2 (1000), n-evaluations: 10
2014-10-16 14:02:18: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:19: n-instances: 6000
2014-10-16 14:02:19: best-f: 3.18609d+2 (1000), n-evaluations: 9
2014-10-16 14:02:19: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:21: n-instances: 7000
2014-10-16 14:02:21: best-f: 2.76913d+2 (1000), n-evaluations: 8
2014-10-16 14:02:21: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:23: n-instances: 8000
2014-10-16 14:02:23: best-f: 3.05168d+2 (1000), n-evaluations: 10
2014-10-16 14:02:23: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:25: n-instances: 9000
2014-10-16 14:02:25: best-f: 3.00009d+2 (1000), n-evaluations: 9
2014-10-16 14:02:25: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:27: n-instances: 10000
2014-10-16 14:02:27: best-f: 2.43869d+2 (1000), n-evaluations: 8
2014-10-16 14:02:27: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:29: n-instances: 11000
2014-10-16 14:02:29: best-f: 2.71098d+2 (1000), n-evaluations: 10
2014-10-16 14:02:29: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:31: n-instances: 12000
2014-10-16 14:02:31: best-f: 2.48760d+2 (1000), n-evaluations: 10
2014-10-16 14:02:31: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:33: n-instances: 13000
2014-10-16 14:02:33: best-f: 2.49425d+2 (1000), n-evaluations: 9
2014-10-16 14:02:33: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:35: n-instances: 14000
2014-10-16 14:02:35: best-f: 2.55176d+2 (1000), n-evaluations: 9
2014-10-16 14:02:35: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:37: n-instances: 15000
2014-10-16 14:02:37: best-f: 2.31819d+2 (1000), n-evaluations: 10
2014-10-16 14:02:37: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:38: n-instances: 16000
2014-10-16 14:02:38: best-f: 2.60371d+2 (1000), n-evaluations: 9
2014-10-16 14:02:38: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:40: n-instances: 17000
2014-10-16 14:02:40: best-f: 2.14672d+2 (1000), n-evaluations: 8
2014-10-16 14:02:40: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:42: n-instances: 18000
2014-10-16 14:02:42: best-f: 2.05539d+2 (1000), n-evaluations: 10
2014-10-16 14:02:42: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:44: n-instances: 19000
2014-10-16 14:02:44: best-f: 2.11168d+2 (1000), n-evaluations: 10
2014-10-16 14:02:44: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:46: n-instances: 20000
2014-10-16 14:02:46: best-f: 2.44276d+2 (1000), n-evaluations: 10
2014-10-16 14:02:46: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:48: n-instances: 21000
2014-10-16 14:02:48: best-f: 2.60124d+2 (1000), n-evaluations: 9
2014-10-16 14:02:48: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:50: n-instances: 22000
2014-10-16 14:02:50: best-f: 2.15166d+2 (1000), n-evaluations: 9
2014-10-16 14:02:50: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:52: n-instances: 23000
2014-10-16 14:02:52: best-f: 2.20091d+2 (1000), n-evaluations: 10
2014-10-16 14:02:52: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:54: n-instances: 24000
2014-10-16 14:02:54: best-f: 2.15159d+2 (1000), n-evaluations: 10
2014-10-16 14:02:54: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:56: n-instances: 25000
2014-10-16 14:02:56: best-f: 2.68606d+2 (1000), n-evaluations: 10
2014-10-16 14:02:56: n-line-searches: 3 (succesful 3)
2014-10-16 14:02:58: n-instances: 26000
2014-10-16 14:02:58: best-f: 2.26297d+2 (1000), n-evaluations: 9
2014-10-16 14:02:58: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:00: n-instances: 27000
2014-10-16 14:03:00: best-f: 2.32968d+2 (1000), n-evaluations: 10
2014-10-16 14:03:00: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:02: n-instances: 28000
2014-10-16 14:03:02: best-f: 2.16941d+2 (1000), n-evaluations: 10
2014-10-16 14:03:02: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:04: n-instances: 29000
2014-10-16 14:03:04: best-f: 2.09807d+2 (1000), n-evaluations: 9
2014-10-16 14:03:04: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:06: n-instances: 30000
2014-10-16 14:03:06: best-f: 1.91969d+2 (1000), n-evaluations: 8
2014-10-16 14:03:06: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:08: n-instances: 31000
2014-10-16 14:03:08: best-f: 2.01207d+2 (1000), n-evaluations: 10
2014-10-16 14:03:08: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:10: n-instances: 32000
2014-10-16 14:03:10: best-f: 2.12430d+2 (1000), n-evaluations: 9
2014-10-16 14:03:10: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:11: n-instances: 33000
2014-10-16 14:03:11: best-f: 1.97070d+2 (1000), n-evaluations: 7
2014-10-16 14:03:11: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:13: n-instances: 34000
2014-10-16 14:03:13: best-f: 1.80359d+2 (1000), n-evaluations: 9
2014-10-16 14:03:13: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:15: n-instances: 35000
2014-10-16 14:03:15: best-f: 1.91918d+2 (1000), n-evaluations: 8
2014-10-16 14:03:15: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:17: n-instances: 36000
2014-10-16 14:03:17: best-f: 2.10914d+2 (1000), n-evaluations: 10
2014-10-16 14:03:17: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:19: n-instances: 37000
2014-10-16 14:03:19: best-f: 2.23318d+2 (1000), n-evaluations: 10
2014-10-16 14:03:19: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:21: n-instances: 38000
2014-10-16 14:03:21: best-f: 2.01737d+2 (1000), n-evaluations: 10
2014-10-16 14:03:21: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:23: n-instances: 39000
2014-10-16 14:03:23: best-f: 2.08272d+2 (1000), n-evaluations: 8
2014-10-16 14:03:23: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:25: n-instances: 40000
2014-10-16 14:03:25: best-f: 1.98619d+2 (1000), n-evaluations: 10
2014-10-16 14:03:25: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:27: n-instances: 41000
2014-10-16 14:03:27: best-f: 1.65413d+2 (1000), n-evaluations: 10
2014-10-16 14:03:27: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:29: n-instances: 42000
2014-10-16 14:03:29: best-f: 1.64963d+2 (1000), n-evaluations: 9
2014-10-16 14:03:29: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:31: n-instances: 43000
2014-10-16 14:03:31: best-f: 2.31643d+2 (1000), n-evaluations: 10
2014-10-16 14:03:31: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:33: n-instances: 44000
2014-10-16 14:03:33: best-f: 2.07925d+2 (1000), n-evaluations: 10
2014-10-16 14:03:33: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:35: n-instances: 45000
2014-10-16 14:03:35: best-f: 1.92972d+2 (1000), n-evaluations: 9
2014-10-16 14:03:35: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:37: n-instances: 46000
2014-10-16 14:03:37: best-f: 1.44208d+2 (1000), n-evaluations: 10
2014-10-16 14:03:37: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:39: n-instances: 47000
2014-10-16 14:03:39: best-f: 2.28942d+2 (1000), n-evaluations: 10
2014-10-16 14:03:39: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:40: n-instances: 48000
2014-10-16 14:03:40: best-f: 2.04179d+2 (1000), n-evaluations: 8
2014-10-16 14:03:40: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:42: n-instances: 49000
2014-10-16 14:03:42: best-f: 1.50537d+2 (1000), n-evaluations: 9
2014-10-16 14:03:42: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:44: n-instances: 50000
2014-10-16 14:03:44: best-f: 2.07187d+2 (1000), n-evaluations: 10
2014-10-16 14:03:44: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:46: n-instances: 51000
2014-10-16 14:03:46: best-f: 1.61800d+2 (1000), n-evaluations: 9
2014-10-16 14:03:46: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:48: n-instances: 52000
2014-10-16 14:03:48: best-f: 1.59678d+2 (1000), n-evaluations: 10
2014-10-16 14:03:48: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:50: n-instances: 53000
2014-10-16 14:03:50: best-f: 1.95551d+2 (1000), n-evaluations: 10
2014-10-16 14:03:50: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:52: n-instances: 54000
2014-10-16 14:03:52: best-f: 1.98721d+2 (1000), n-evaluations: 10
2014-10-16 14:03:52: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:54: n-instances: 55000
2014-10-16 14:03:54: best-f: 1.76958d+2 (1000), n-evaluations: 9
2014-10-16 14:03:54: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:56: n-instances: 56000
2014-10-16 14:03:56: best-f: 1.69052d+2 (1000), n-evaluations: 9
2014-10-16 14:03:56: n-line-searches: 3 (succesful 3)
2014-10-16 14:03:58: n-instances: 57000
2014-10-16 14:03:58: best-f: 2.03226d+2 (1000), n-evaluations: 9
2014-10-16 14:03:58: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:00: n-instances: 58000
2014-10-16 14:04:00: best-f: 1.64505d+2 (1000), n-evaluations: 9
2014-10-16 14:04:00: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:02: n-instances: 59000
2014-10-16 14:04:02: best-f: 1.77901d+2 (1000), n-evaluations: 10
2014-10-16 14:04:02: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:02: test at n-instances: 60000
2014-10-16 14:04:04: pred. test bpn PREDICTIONS acc.: 93.61% (10000)
2014-10-16 14:04:04: pred. test bpn PREDICTIONS xent: 2.144d-4 (10000)
2014-10-16 14:04:04: cuda mats: 70059, copies: h->d: 70608, d->h: 1190
2014-10-16 14:04:04: ---------------------------------------------------
2014-10-16 14:04:04: Starting to train the whole BPN
2014-10-16 14:04:04: Describing gradient source:
#<BP-LEARNER {10429E6173}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN :N-STRIPES 1000 :MAX-N-STRIPES 1000 {1004676B83}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = NIL

BP-LEARNER description:
  BPN = #<MNIST-BPN :N-STRIPES 1000 :MAX-N-STRIPES 1000 {1004676B83}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN {1004676B83}>
BPN description:
  LUMPS = #(#<->INPUT (:CHUNK INPUTS) :SIZE
              784*1000(1000/1000) :norm 298.81957>
            #<->CONSTANT (:CHUNK C0) :SIZE
              1*1000(1000/1000) :norm 31.62278>
            #<->WEIGHT (:CLOUD #1=(INPUTS F1)) :SIZE
              392000*1(1/1) :norm 99.85369>
            #<->ACTIVATION (:CLOUD #1# . #2=(:LINEAR)) :SIZE
              500*1000(1000/1000) :norm 3001.27081>
            #<->WEIGHT (:CLOUD #3=(C0 F1)) :SIZE
              500*1(1/1) :norm 28.44436>
            #<->ACTIVATION (:CLOUD #3# . #2#) :SIZE
              500*1000(1000/1000) :norm 899.48976>
            #<->+ (:CHUNK F1 . #4=(:ACTIVATION)) :SIZE
              500*1000(1000/1000) :norm 2518.65002>
            #<->SIGMOID (:CHUNK F1) :SIZE
              500*1000(1000/1000) :norm 371.78344>
            #<->CONSTANT (:CHUNK C1) :SIZE
              1*1000(1000/1000) :norm 31.62278>
            #<->WEIGHT (:CLOUD #5=(F1 F2)) :SIZE
              250000*1(1/1) :norm 71.69626>
            #<->ACTIVATION (:CLOUD #5# . #2#) :SIZE
              500*1000(1000/1000) :norm 3121.63049>
            #<->WEIGHT (:CLOUD #6=(C1 F2)) :SIZE
              500*1(1/1) :norm 4.61589>
            #<->ACTIVATION (:CLOUD #6# . #2#) :SIZE
              500*1000(1000/1000) :norm 145.96717>
            #<->+ (:CHUNK F2 . #4#) :SIZE
              500*1000(1000/1000) :norm 3072.18110>
            #<->SIGMOID (:CHUNK F2) :SIZE
              500*1000(1000/1000) :norm 311.94166>
            #<->CONSTANT (:CHUNK C2) :SIZE
              1*1000(1000/1000) :norm 31.62278>
            #<->WEIGHT (:CLOUD #7=(F2 F3)) :SIZE
              1000000*1(1/1) :norm 115.95142>
            #<->ACTIVATION (:CLOUD #7# . #2#) :SIZE
              2000*1000(1000/1000) :norm 9767.31603>
            #<->WEIGHT (:CLOUD #8=(C2 F3)) :SIZE
              2000*1(1/1) :norm 5.88131>
            #<->ACTIVATION (:CLOUD #8# . #2#) :SIZE
              2000*1000(1000/1000) :norm 185.98327>
            #<->+ (:CHUNK F3 . #4#) :SIZE
              2000*1000(1000/1000) :norm 9915.97796>
            #<->SIGMOID #9=(:CHUNK F3) :SIZE
              2000*1000(1000/1000) :norm 367.78482>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.26823>
            #<->WEIGHT #10=(#9# PREDICTIONS) :SIZE
              20000*1(1/1) :norm 17.24825>
            #<->ACTIVATION (#10# :ACTIVATION) :SIZE
              10*1000(1000/1000) :norm 402.60083>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1000(1000/1000) :norm 403.26238>
            #<->INPUT EXPECTATIONS :SIZE
              10*1000(1000/1000) :norm 31.62278>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1000(1000/1000) :norm 22.24892>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1000(1000/1000) :norm 22.24892>)
  N-STRIPES = 1000
  MAX-N-STRIPES = 1000
2014-10-16 14:04:04: Describing optimizer:
#<MNIST-CG-BP-OPTIMIZER {10429E5EF3}>
CG-OPTIMIZER description:
  N-INSTANCES = 0
  BATCH-SIZE = 1000
  CG-ARGS = (:MAX-N-LINE-SEARCHES 3)
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (INPUTS F1)) :SIZE
                     392000*1(1/1) :norm 99.85369>
                   #<->WEIGHT (:CLOUD (C0 F1)) :SIZE
                     500*1(1/1) :norm 28.44436>
                   #<->WEIGHT (:CLOUD (F1 F2)) :SIZE
                     250000*1(1/1) :norm 71.69626>
                   #<->WEIGHT (:CLOUD (C1 F2)) :SIZE
                     500*1(1/1) :norm 4.61589>
                   #<->WEIGHT (:CLOUD (F2 F3)) :SIZE
                     1000000*1(1/1) :norm 115.95142>
                   #<->WEIGHT (:CLOUD (C2 F3)) :SIZE
                     2000*1(1/1) :norm 5.88131>
                   #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.26823>
                   #<->WEIGHT ((:CHUNK F3) PREDICTIONS) :SIZE
                     20000*1(1/1) :norm 17.24825>)
                  {10429E6473}>
2014-10-16 14:04:04: cuda mats: 70059, copies: h->d: 70608, d->h: 1209
2014-10-16 14:04:04: test at n-instances: 0
2014-10-16 14:04:06: pred. test bpn PREDICTIONS acc.: 93.61% (10000)
2014-10-16 14:04:06: pred. test bpn PREDICTIONS xent: 2.144d-4 (10000)
2014-10-16 14:04:06: cuda mats: 70059, copies: h->d: 70618, d->h: 1229
2014-10-16 14:04:06: ---------------------------------------------------
2014-10-16 14:04:11: n-instances: 0
2014-10-16 14:04:11: best-f: 1.35511d+2 (1000), n-evaluations: 9
2014-10-16 14:04:11: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:17: n-instances: 1000
2014-10-16 14:04:17: best-f: 1.26697d+2 (1000), n-evaluations: 10
2014-10-16 14:04:17: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:22: n-instances: 2000
2014-10-16 14:04:22: best-f: 1.50090d+2 (1000), n-evaluations: 10
2014-10-16 14:04:22: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:28: n-instances: 3000
2014-10-16 14:04:28: best-f: 1.43853d+2 (1000), n-evaluations: 10
2014-10-16 14:04:28: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:34: n-instances: 4000
2014-10-16 14:04:34: best-f: 1.43806d+2 (1000), n-evaluations: 10
2014-10-16 14:04:34: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:39: n-instances: 5000
2014-10-16 14:04:39: best-f: 1.43767d+2 (1000), n-evaluations: 10
2014-10-16 14:04:39: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:45: n-instances: 6000
2014-10-16 14:04:45: best-f: 1.45650d+2 (1000), n-evaluations: 10
2014-10-16 14:04:45: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:51: n-instances: 7000
2014-10-16 14:04:51: best-f: 1.52767d+2 (1000), n-evaluations: 10
2014-10-16 14:04:51: n-line-searches: 3 (succesful 3)
2014-10-16 14:04:56: n-instances: 8000
2014-10-16 14:04:56: best-f: 1.50337d+2 (1000), n-evaluations: 10
2014-10-16 14:04:56: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:02: n-instances: 9000
2014-10-16 14:05:02: best-f: 1.69619d+2 (1000), n-evaluations: 10
2014-10-16 14:05:02: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:07: n-instances: 10000
2014-10-16 14:05:07: best-f: 1.78592d+2 (1000), n-evaluations: 8
2014-10-16 14:05:07: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:12: n-instances: 11000
2014-10-16 14:05:12: best-f: 1.05860d+2 (1000), n-evaluations: 10
2014-10-16 14:05:12: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:18: n-instances: 12000
2014-10-16 14:05:18: best-f: 1.11462d+2 (1000), n-evaluations: 10
2014-10-16 14:05:18: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:22: n-instances: 13000
2014-10-16 14:05:22: best-f: 1.17560d+2 (1000), n-evaluations: 8
2014-10-16 14:05:22: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:28: n-instances: 14000
2014-10-16 14:05:28: best-f: 1.74287d+2 (1000), n-evaluations: 10
2014-10-16 14:05:28: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:34: n-instances: 15000
2014-10-16 14:05:34: best-f: 1.35020d+2 (1000), n-evaluations: 10
2014-10-16 14:05:34: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:38: n-instances: 16000
2014-10-16 14:05:38: best-f: 1.15944d+2 (1000), n-evaluations: 8
2014-10-16 14:05:38: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:44: n-instances: 17000
2014-10-16 14:05:44: best-f: 1.10307d+2 (1000), n-evaluations: 10
2014-10-16 14:05:44: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:50: n-instances: 18000
2014-10-16 14:05:50: best-f: 1.26506d+2 (1000), n-evaluations: 10
2014-10-16 14:05:50: n-line-searches: 3 (succesful 3)
2014-10-16 14:05:55: n-instances: 19000
2014-10-16 14:05:55: best-f: 1.05562d+2 (1000), n-evaluations: 10
2014-10-16 14:05:55: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:00: n-instances: 20000
2014-10-16 14:06:00: best-f: 1.14753d+2 (1000), n-evaluations: 9
2014-10-16 14:06:00: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:06: n-instances: 21000
2014-10-16 14:06:06: best-f: 1.31455d+2 (1000), n-evaluations: 10
2014-10-16 14:06:06: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:11: n-instances: 22000
2014-10-16 14:06:11: best-f: 1.03130d+2 (1000), n-evaluations: 9
2014-10-16 14:06:11: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:17: n-instances: 23000
2014-10-16 14:06:17: best-f: 9.89001d+1 (1000), n-evaluations: 10
2014-10-16 14:06:17: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:22: n-instances: 24000
2014-10-16 14:06:22: best-f: 1.39960d+2 (1000), n-evaluations: 10
2014-10-16 14:06:22: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:28: n-instances: 25000
2014-10-16 14:06:28: best-f: 1.22802d+2 (1000), n-evaluations: 10
2014-10-16 14:06:28: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:34: n-instances: 26000
2014-10-16 14:06:34: best-f: 1.01987d+2 (1000), n-evaluations: 10
2014-10-16 14:06:34: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:39: n-instances: 27000
2014-10-16 14:06:39: best-f: 1.02627d+2 (1000), n-evaluations: 9
2014-10-16 14:06:39: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:44: n-instances: 28000
2014-10-16 14:06:44: best-f: 1.00621d+2 (1000), n-evaluations: 9
2014-10-16 14:06:44: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:50: n-instances: 29000
2014-10-16 14:06:50: best-f: 1.22499d+2 (1000), n-evaluations: 10
2014-10-16 14:06:50: n-line-searches: 3 (succesful 3)
2014-10-16 14:06:55: n-instances: 30000
2014-10-16 14:06:55: best-f: 8.74793d+1 (1000), n-evaluations: 10
2014-10-16 14:06:55: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:01: n-instances: 31000
2014-10-16 14:07:01: best-f: 1.00774d+2 (1000), n-evaluations: 10
2014-10-16 14:07:01: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:07: n-instances: 32000
2014-10-16 14:07:07: best-f: 7.21164d+1 (1000), n-evaluations: 10
2014-10-16 14:07:07: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:12: n-instances: 33000
2014-10-16 14:07:12: best-f: 9.85783d+1 (1000), n-evaluations: 10
2014-10-16 14:07:12: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:18: n-instances: 34000
2014-10-16 14:07:18: best-f: 7.23078d+1 (1000), n-evaluations: 10
2014-10-16 14:07:18: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:24: n-instances: 35000
2014-10-16 14:07:24: best-f: 1.03789d+2 (1000), n-evaluations: 10
2014-10-16 14:07:24: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:29: n-instances: 36000
2014-10-16 14:07:29: best-f: 8.84205d+1 (1000), n-evaluations: 10
2014-10-16 14:07:29: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:35: n-instances: 37000
2014-10-16 14:07:35: best-f: 8.01803d+1 (1000), n-evaluations: 10
2014-10-16 14:07:35: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:41: n-instances: 38000
2014-10-16 14:07:41: best-f: 1.02081d+2 (1000), n-evaluations: 10
2014-10-16 14:07:41: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:46: n-instances: 39000
2014-10-16 14:07:46: best-f: 1.08389d+2 (1000), n-evaluations: 9
2014-10-16 14:07:46: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:51: n-instances: 40000
2014-10-16 14:07:51: best-f: 8.90511d+1 (1000), n-evaluations: 10
2014-10-16 14:07:51: n-line-searches: 3 (succesful 3)
2014-10-16 14:07:57: n-instances: 41000
2014-10-16 14:07:57: best-f: 6.96127d+1 (1000), n-evaluations: 10
2014-10-16 14:07:57: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:03: n-instances: 42000
2014-10-16 14:08:03: best-f: 1.07102d+2 (1000), n-evaluations: 10
2014-10-16 14:08:03: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:08: n-instances: 43000
2014-10-16 14:08:08: best-f: 8.09239d+1 (1000), n-evaluations: 9
2014-10-16 14:08:08: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:12: n-instances: 44000
2014-10-16 14:08:12: best-f: 7.88538d+1 (1000), n-evaluations: 8
2014-10-16 14:08:12: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:18: n-instances: 45000
2014-10-16 14:08:18: best-f: 8.84285d+1 (1000), n-evaluations: 10
2014-10-16 14:08:18: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:23: n-instances: 46000
2014-10-16 14:08:23: best-f: 9.56745d+1 (1000), n-evaluations: 9
2014-10-16 14:08:23: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:28: n-instances: 47000
2014-10-16 14:08:28: best-f: 9.22788d+1 (1000), n-evaluations: 9
2014-10-16 14:08:28: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:34: n-instances: 48000
2014-10-16 14:08:34: best-f: 7.23334d+1 (1000), n-evaluations: 10
2014-10-16 14:08:34: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:39: n-instances: 49000
2014-10-16 14:08:39: best-f: 9.28234d+1 (1000), n-evaluations: 10
2014-10-16 14:08:39: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:45: n-instances: 50000
2014-10-16 14:08:45: best-f: 8.92950d+1 (1000), n-evaluations: 10
2014-10-16 14:08:45: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:51: n-instances: 51000
2014-10-16 14:08:51: best-f: 9.28024d+1 (1000), n-evaluations: 10
2014-10-16 14:08:51: n-line-searches: 3 (succesful 3)
2014-10-16 14:08:56: n-instances: 52000
2014-10-16 14:08:56: best-f: 6.94310d+1 (1000), n-evaluations: 10
2014-10-16 14:08:56: n-line-searches: 3 (succesful 3)
2014-10-16 14:09:02: n-instances: 53000
2014-10-16 14:09:02: best-f: 7.65343d+1 (1000), n-evaluations: 10
2014-10-16 14:09:02: n-line-searches: 3 (succesful 3)
2014-10-16 14:09:08: n-instances: 54000
2014-10-16 14:09:08: best-f: 7.91984d+1 (1000), n-evaluations: 10
2014-10-16 14:09:08: n-line-searches: 3 (succesful 3)
2014-10-16 14:09:14: n-instances: 55000
2014-10-16 14:09:14: best-f: 8.59348d+1 (1000), n-evaluations: 11
2014-10-16 14:09:14: n-line-searches: 3 (succesful 3)
2014-10-16 14:09:20: n-instances: 56000
2014-10-16 14:09:20: best-f: 8.50352d+1 (1000), n-evaluations: 10
2014-10-16 14:09:20: n-line-searches: 3 (succesful 3)
2014-10-16 14:09:25: n-instances: 57000
2014-10-16 14:09:25: best-f: 8.27517d+1 (1000), n-evaluations: 9
2014-10-16 14:09:25: n-line-searches: 3 (succesful 3)
2014-10-16 14:09:29: n-instances: 58000
2014-10-16 14:09:29: best-f: 7.95823d+1 (1000), n-evaluations: 8
2014-10-16 14:09:29: n-line-searches: 3 (succesful 3)
2014-10-16 14:09:34: n-instances: 59000
2014-10-16 14:09:34: best-f: 8.92728d+1 (1000), n-evaluations: 9
2014-10-16 14:09:34: n-line-searches: 3 (succesful 3)
2014-10-16 14:09:34: test at n-instances: 60000
2014-10-16 14:09:36: pred. test bpn PREDICTIONS acc.: 96.05% (10000)
2014-10-16 14:09:36: pred. test bpn PREDICTIONS xent: 1.283d-4 (10000)
2014-10-16 14:09:36: cuda mats: 70081, copies: h->d: 71208, d->h: 2409
2014-10-16 14:09:36: ---------------------------------------------------
2014-10-16 14:09:37: TRAIN-MNIST/1 :DROPOUTP T
2014-10-16 14:09:38: init: #<FULL-CLOUD (INPUTS F1) :NORM 6.25386d+0> 0.1
2014-10-16 14:09:38: init: #<FULL-CLOUD (F1 F2) :NORM 4.99276d+0> 0.1
2014-10-16 14:09:38: init: #<FULL-CLOUD (F2 F3) :NORM 1.00118d+1> 0.1
2014-10-16 14:09:38: Starting to train level 0 RBM in DBN.
2014-10-16 14:09:38: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {104110DB13}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM (C0 INPUTS) - (C1 F1)>
  MONITORS                   = (#<MONITOR train train+ rbm INPUTS rmse: 0.000e+0 (0)>)
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = NIL
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 1
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {104110CAB3}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = NIL
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 1

#<MNIST-RBM {1040D742C3}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C0 1(1/100)>
                    #<SIGMOID-CHUNK INPUTS 784(1/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C1 1(1/100)>
                   #<SIGMOID-CHUNK F1 500(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>
            #<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>
            #<FULL-CLOUD (INPUTS F1) :NORM 6.25445d+1>)
  N-STRIPES = 1
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN/1 {1040D6B913}>

2014-10-16 14:09:38: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {104110CAB3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d+1>)
                    {104110F6A3}>
                  {104110E2A3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>)
                    {104110EF13}>
                  {104110E1B3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)
                    {104110E393}>
                  {104110E0C3}>)
  SEGMENTS = (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d+1>
              #<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>
              #<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {104110E2A3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d+1>)
                  {104110F6A3}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {104110E1B3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>)
                  {104110EF13}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {104110E0C3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)
                  {104110E393}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:09:38: cuda mats: 41, copies: h->d: 0, d->h: 3
2014-10-16 14:09:38: test at n-instances: 0
2014-10-16 14:09:39: pred. test+ dbn l0, rbm INPUTS rmse: 5.215d-1 (7840000)
2014-10-16 14:09:39: cuda mats: 10047, copies: h->d: 10000, d->h: 3
2014-10-16 14:09:39: ---------------------------------------------------
2014-10-16 14:09:58: training at n-instances: 60000
2014-10-16 14:09:58: train train+ rbm INPUTS rmse: 1.382d-1 (47040000)
2014-10-16 14:09:58: test at n-instances: 60000
2014-10-16 14:09:59: pred. test+ dbn l0, rbm INPUTS rmse: 8.175d-2 (7840000)
2014-10-16 14:09:59: cuda mats: 70054, copies: h->d: 70000, d->h: 3
2014-10-16 14:09:59: ---------------------------------------------------
2014-10-16 14:10:15: training at n-instances: 120000
2014-10-16 14:10:15: train train+ rbm INPUTS rmse: 1.084d-1 (47040000)
2014-10-16 14:10:15: test at n-instances: 120000
2014-10-16 14:10:17: pred. test+ dbn l0, rbm INPUTS rmse: 6.940d-2 (7840000)
2014-10-16 14:10:17: cuda mats: 70054, copies: h->d: 70000, d->h: 3
2014-10-16 14:10:17: ---------------------------------------------------
2014-10-16 14:10:17: Starting to train level 1 RBM in DBN.
2014-10-16 14:10:17: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {106488F353}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM (C1 F1) - (C2 F2)>
  MONITORS                   = (#<MONITOR train train+ rbm F1 rmse: 0.000e+0 (0)>)
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = NIL
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 1
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {106488E783}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = NIL
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 1

#<MNIST-RBM {10462CBDD3}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C1 1(100/100)>
                    #<SIGMOID-CHUNK F1 500(100/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C2 1(1/100)>
                   #<SIGMOID-CHUNK F2 500(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>
            #<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>
            #<FULL-CLOUD (F1 F2) :NORM 5.00045d+1>)
  N-STRIPES = 100
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN/1 {1040D6B913}>

2014-10-16 14:10:17: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {106488E783}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 F2) :NORM 5.00045d+1>)
                    {1064980B03}>
                  {106488FAE3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>)
                    {1064980373}>
                  {106488F9F3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)
                    {106488FBD3}>
                  {106488F903}>)
  SEGMENTS = (#<FULL-CLOUD (F1 F2) :NORM 5.00045d+1>
              #<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>
              #<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {106488FAE3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 F2) :NORM 5.00045d+1>)
                  {1064980B03}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {106488F9F3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>)
                  {1064980373}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {106488F903}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)
                  {106488FBD3}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:10:17: cuda mats: 70048, copies: h->d: 70000, d->h: 6
2014-10-16 14:10:17: test at n-instances: 0
2014-10-16 14:10:19: pred. test+ dbn l0, rbm INPUTS rmse: 3.194d-1 (7840000)
2014-10-16 14:10:19: pred. test+ dbn l1, rbm F1     rmse: 4.153d-1 (5000000)
2014-10-16 14:10:19: cuda mats: 70054, copies: h->d: 70000, d->h: 6
2014-10-16 14:10:19: ---------------------------------------------------
2014-10-16 14:10:33: training at n-instances: 60000
2014-10-16 14:10:33: train train+ rbm F1 rmse: 1.791d-1 (30000000)
2014-10-16 14:10:33: test at n-instances: 60000
2014-10-16 14:10:35: pred. test+ dbn l0, rbm INPUTS rmse: 9.856d-2 (7840000)
2014-10-16 14:10:35: pred. test+ dbn l1, rbm F1     rmse: 9.226d-2 (5000000)
2014-10-16 14:10:35: cuda mats: 70061, copies: h->d: 70000, d->h: 6
2014-10-16 14:10:35: ---------------------------------------------------
2014-10-16 14:10:49: training at n-instances: 120000
2014-10-16 14:10:49: train train+ rbm F1 rmse: 1.449d-1 (30000000)
2014-10-16 14:10:49: test at n-instances: 120000
2014-10-16 14:10:51: pred. test+ dbn l0, rbm INPUTS rmse: 9.599d-2 (7840000)
2014-10-16 14:10:51: pred. test+ dbn l1, rbm F1     rmse: 8.186d-2 (5000000)
2014-10-16 14:10:51: cuda mats: 70061, copies: h->d: 70000, d->h: 6
2014-10-16 14:10:51: ---------------------------------------------------
2014-10-16 14:10:51: Starting to train level 2 RBM in DBN.
2014-10-16 14:10:51: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {1042DB2C33}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM (C2 F2) - (C3 F3)>
  MONITORS                   = (#<MONITOR train train+ rbm F2 rmse: 0.000e+0 (0)>)
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = NIL
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 1
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {1042DB2063}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = NIL
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 1

#<MNIST-RBM {1043BD08C3}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C2 1(100/100)>
                    #<SIGMOID-CHUNK F2 500(100/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C3 1(1/100)>
                   #<SIGMOID-CHUNK F3 2000(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C2 F3) :NORM 0.00000d+0>
            #<FULL-CLOUD (F2 C3) :NORM 0.00000d+0>
            #<FULL-CLOUD (F2 F3) :NORM 9.98857d+1>)
  N-STRIPES = 100
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN/1 {1040D6B913}>

2014-10-16 14:10:51: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {1042DB2063}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F2 F3) :NORM 9.98857d+1>)
                    {1042DB43D3}>
                  {1042DB33C3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F2 C3) :NORM 0.00000d+0>)
                    {1042DB3C43}>
                  {1042DB32D3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C2 F3) :NORM 0.00000d+0>)
                    {1042DB34B3}>
                  {1042DB31E3}>)
  SEGMENTS = (#<FULL-CLOUD (F2 F3) :NORM 9.98857d+1>
              #<FULL-CLOUD (F2 C3) :NORM 0.00000d+0>
              #<FULL-CLOUD (C2 F3) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {1042DB33C3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F2 F3) :NORM 9.98857d+1>)
                  {1042DB43D3}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {1042DB32D3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F2 C3) :NORM 0.00000d+0>)
                  {1042DB3C43}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {1042DB31E3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C2 F3) :NORM 0.00000d+0>)
                  {1042DB34B3}>
  LEARNING-RATE = 1.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:10:51: cuda mats: 70053, copies: h->d: 70000, d->h: 9
2014-10-16 14:10:51: test at n-instances: 0
2014-10-16 14:10:56: pred. test+ dbn l0, rbm INPUTS rmse: 2.974d-1 (7840000)
2014-10-16 14:10:56: pred. test+ dbn l1, rbm F1     rmse: 4.073d-1 (5000000)
2014-10-16 14:10:56: pred. test+ dbn l2, rbm F2     rmse: 5.084d-1 (5000000)
2014-10-16 14:10:56: cuda mats: 70059, copies: h->d: 70000, d->h: 9
2014-10-16 14:10:56: ---------------------------------------------------
2014-10-16 14:11:41: training at n-instances: 60000
2014-10-16 14:11:41: train train+ rbm F2 rmse: 1.504d-1 (30000000)
2014-10-16 14:11:41: test at n-instances: 60000
2014-10-16 14:11:45: pred. test+ dbn l0, rbm INPUTS rmse: 1.116d-1 (7840000)
2014-10-16 14:11:45: pred. test+ dbn l1, rbm F1     rmse: 1.106d-1 (5000000)
2014-10-16 14:11:45: pred. test+ dbn l2, rbm F2     rmse: 6.187d-2 (5000000)
2014-10-16 14:11:45: cuda mats: 70066, copies: h->d: 70000, d->h: 9
2014-10-16 14:11:45: ---------------------------------------------------
2014-10-16 14:12:30: training at n-instances: 120000
2014-10-16 14:12:30: train train+ rbm F2 rmse: 1.249d-1 (30000000)
2014-10-16 14:12:30: test at n-instances: 120000
2014-10-16 14:12:35: pred. test+ dbn l0, rbm INPUTS rmse: 1.108d-1 (7840000)
2014-10-16 14:12:35: pred. test+ dbn l1, rbm F1     rmse: 1.082d-1 (5000000)
2014-10-16 14:12:35: pred. test+ dbn l2, rbm F2     rmse: 5.623d-2 (5000000)
2014-10-16 14:12:35: cuda mats: 70066, copies: h->d: 70000, d->h: 9
2014-10-16 14:12:35: ---------------------------------------------------
2014-10-16 14:12:36: bpn inits:
((:CLOUD-NAME (C2 F3) :WEIGHT-NAME (:CLOUD (C2 F3)))
 (:CLOUD-NAME (F2 F3) :WEIGHT-NAME (:CLOUD (F2 F3)))
 (:CLOUD-NAME (C1 F2) :WEIGHT-NAME (:CLOUD (C1 F2)))
 (:CLOUD-NAME (F1 F2) :WEIGHT-NAME (:CLOUD (F1 F2)))
 (:CLOUD-NAME (C0 F1) :WEIGHT-NAME (:CLOUD (C0 F1)))
 (:CLOUD-NAME (INPUTS F1) :WEIGHT-NAME (:CLOUD (INPUTS F1))))
2014-10-16 14:12:36: bpn def:
(BUILD-BPN (:CLASS 'MNIST-BPN :MAX-N-STRIPES 1000 :INITARGS 'NIL)
  (#:G70858 (->INPUT :NAME '(:CHUNK INPUTS) :SIZE 784))
  (#:G70857 (->CONSTANT :NAME '(:CHUNK C0) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G70862 (->WEIGHT :NAME '(:CLOUD (INPUTS F1)) :SIZE 392000))
  (#:G70863
   (->ACTIVATION :NAME '(:CLOUD (INPUTS F1) :LINEAR) :SIZE 500 :WEIGHTS
                 #:G70862 :X #:G70858 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G70864 (->WEIGHT :NAME '(:CLOUD (C0 F1)) :SIZE 500))
  (#:G70865
   (->ACTIVATION :NAME '(:CLOUD (C0 F1) :LINEAR) :SIZE 500 :WEIGHTS #:G70864 :X
                 #:G70857 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G70861 (->+ :NAME '(:CHUNK F1 :ACTIVATION) :ARGS (LIST #:G70863 #:G70865)))
  (#:G70856 (->SIGMOID :NAME '(:CHUNK F1) :X #:G70861))
  (#:G70855 (->CONSTANT :NAME '(:CHUNK C1) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G70868 (->WEIGHT :NAME '(:CLOUD (F1 F2)) :SIZE 250000))
  (#:G70869
   (->ACTIVATION :NAME '(:CLOUD (F1 F2) :LINEAR) :SIZE 500 :WEIGHTS #:G70868 :X
                 #:G70856 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G70870 (->WEIGHT :NAME '(:CLOUD (C1 F2)) :SIZE 500))
  (#:G70871
   (->ACTIVATION :NAME '(:CLOUD (C1 F2) :LINEAR) :SIZE 500 :WEIGHTS #:G70870 :X
                 #:G70855 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G70867 (->+ :NAME '(:CHUNK F2 :ACTIVATION) :ARGS (LIST #:G70869 #:G70871)))
  (#:G70854 (->SIGMOID :NAME '(:CHUNK F2) :X #:G70867))
  (#:G70852 (->CONSTANT :NAME '(:CHUNK C2) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G70874 (->WEIGHT :NAME '(:CLOUD (F2 F3)) :SIZE 1000000))
  (#:G70875
   (->ACTIVATION :NAME '(:CLOUD (F2 F3) :LINEAR) :SIZE 2000 :WEIGHTS #:G70874
                 :X #:G70854 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G70876 (->WEIGHT :NAME '(:CLOUD (C2 F3)) :SIZE 2000))
  (#:G70877
   (->ACTIVATION :NAME '(:CLOUD (C2 F3) :LINEAR) :SIZE 2000 :WEIGHTS #:G70876
                 :X #:G70852 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G70873 (->+ :NAME '(:CHUNK F3 :ACTIVATION) :ARGS (LIST #:G70875 #:G70877)))
  (#:G70853 (->SIGMOID :NAME '(:CHUNK F3) :X #:G70873)))
2014-10-16 14:12:36: Starting to train the softmax layer of BPN
2014-10-16 14:12:36: Describing gradient source:
#<BP-LEARNER {1042C5D4A3}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 100 {1042B2AD53}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = (#<MONITOR #1=train #2=train+ #3=bpn PREDICTIONS acc.: 0.00% (0)>..

BP-LEARNER description:
  BPN = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 100 {1042B2AD53}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN {1042B2AD53}>
BPN description:
  LUMPS = #(#<->INPUT (:CHUNK INPUTS) :SIZE 784*1(1/100) :norm 0.00000>
            #<->CONSTANT (:CHUNK C0) :SIZE 1*1(1/100) :norm 1.00000>
            #<->WEIGHT (:CLOUD #1=(INPUTS F1)) :SIZE
              392000*1(1/1) :norm 99.85369>
            #<->ACTIVATION (:CLOUD #1# . #2=(:LINEAR)) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->WEIGHT (:CLOUD #3=(C0 F1)) :SIZE
              500*1(1/1) :norm 28.44436>
            #<->ACTIVATION (:CLOUD #3# . #2#) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->+ (:CHUNK F1 . #4=(:ACTIVATION)) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->SIGMOID (:CHUNK F1) :SIZE 500*1(1/100) :norm 0.00000>
            #<->CONSTANT (:CHUNK C1) :SIZE 1*1(1/100) :norm 1.00000>
            #<->WEIGHT (:CLOUD #5=(F1 F2)) :SIZE
              250000*1(1/1) :norm 71.69626>
            #<->ACTIVATION (:CLOUD #5# . #2#) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->WEIGHT (:CLOUD #6=(C1 F2)) :SIZE
              500*1(1/1) :norm 4.61589>
            #<->ACTIVATION (:CLOUD #6# . #2#) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->+ (:CHUNK F2 . #4#) :SIZE 500*1(1/100) :norm 0.00000>
            #<->SIGMOID (:CHUNK F2) :SIZE 500*1(1/100) :norm 0.00000>
            #<->CONSTANT (:CHUNK C2) :SIZE 1*1(1/100) :norm 1.00000>
            #<->WEIGHT (:CLOUD #7=(F2 F3)) :SIZE
              1000000*1(1/1) :norm 115.95142>
            #<->ACTIVATION (:CLOUD #7# . #2#) :SIZE
              2000*1(1/100) :norm 0.00000>
            #<->WEIGHT (:CLOUD #8=(C2 F3)) :SIZE
              2000*1(1/1) :norm 5.88131>
            #<->ACTIVATION (:CLOUD #8# . #2#) :SIZE
              2000*1(1/100) :norm 0.00000>
            #<->+ (:CHUNK F3 . #4#) :SIZE 2000*1(1/100) :norm 0.00000>
            #<->SIGMOID #9=(:CHUNK F3) :SIZE
              2000*1(1/100) :norm 0.00000>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.28631>
            #<->WEIGHT #10=(#9# PREDICTIONS) :SIZE
              20000*1(1/1) :norm 13.98526>
            #<->ACTIVATION (#10# :ACTIVATION) :SIZE
              10*1(1/100) :norm 0.00000>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1(1/100) :norm 0.00000>
            #<->INPUT EXPECTATIONS :SIZE 10*1(1/100) :norm 0.00000>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1(1/100) :norm 0.00000>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1(1/100) :norm 0.00000>)
  N-STRIPES = 1
  MAX-N-STRIPES = 100
2014-10-16 14:12:36: Describing optimizer:
#<MNIST-BPN-GD-OPTIMIZER {1042C595A3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT ((:CHUNK F3) PREDICTIONS) :SIZE
                       20000*1(1/1) :norm 13.98526>)
                    {1042DC94D3}>
                  {1042DC7093}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                       10*1(1/1) :norm 0.28631>)
                    {1042DC7883}>
                  {1042DC6F53}>)
  SEGMENTS = (#<->WEIGHT ((:CHUNK F3) PREDICTIONS) :SIZE
                20000*1(1/1) :norm 13.98526>
              #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                10*1(1/1) :norm 0.28631>)

#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1042DC7093}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT ((:CHUNK F3) PREDICTIONS) :SIZE
                     20000*1(1/1) :norm 13.98526>)
                  {1042DC94D3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1042DC6F53}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.28631>)
                  {1042DC7883}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:12:36: cuda mats: 15, copies: h->d: 6, d->h: 8
2014-10-16 14:12:36: test at n-instances: 0
2014-10-16 14:12:38: pred. test bpn PREDICTIONS acc.: 10.37% (10000)
2014-10-16 14:12:38: pred. test bpn PREDICTIONS xent: 2.883d-2 (10000)
2014-10-16 14:12:38: cuda mats: 10038, copies: h->d: 10117, d->h: 208
2014-10-16 14:12:38: ---------------------------------------------------
2014-10-16 14:12:57: training at n-instances: 60000
2014-10-16 14:12:57: train train+ bpn PREDICTIONS acc.: 91.14% (60000)
2014-10-16 14:12:57: train train+ bpn PREDICTIONS xent: 3.071d-3 (60000)
2014-10-16 14:12:57: test at n-instances: 60000
2014-10-16 14:12:59: pred. test bpn PREDICTIONS acc.: 93.74% (10000)
2014-10-16 14:12:59: pred. test bpn PREDICTIONS xent: 2.170d-3 (10000)
2014-10-16 14:12:59: cuda mats: 70056, copies: h->d: 70817, d->h: 2208
2014-10-16 14:12:59: ---------------------------------------------------
2014-10-16 14:12:59: dropout #<->INPUT (:CHUNK INPUTS) :SIZE
                               784*100(100/100) :norm 94.08260> 0.2
2014-10-16 14:12:59: dropout #<->SIGMOID (:CHUNK F1) :SIZE
                               500*100(100/100) :norm 118.12746> 0.5
2014-10-16 14:12:59: dropout #<->SIGMOID (:CHUNK F2) :SIZE
                               500*100(100/100) :norm 98.13294> 0.5
2014-10-16 14:12:59: dropout #<->SIGMOID (:CHUNK F3) :SIZE
                               2000*100(100/100) :norm 116.72581> 0.5
2014-10-16 14:12:59: Starting to train the whole BPN
2014-10-16 14:12:59: Describing gradient source:
#<BP-LEARNER {103078A523}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN :N-STRIPES 100 :MAX-N-STRIPES 100 {1042B2AD53}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = (#<MONITOR #1=train #2=train+ #3=bpn PREDICTIONS acc.: 0.00% (0)>..

BP-LEARNER description:
  BPN = #<MNIST-BPN :N-STRIPES 100 :MAX-N-STRIPES 100 {1042B2AD53}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN {1042B2AD53}>
BPN description:
  LUMPS = #(#<->INPUT (:CHUNK INPUTS) :SIZE
              784*100(100/100) :norm 94.08260>
            #<->CONSTANT (:CHUNK C0) :SIZE
              1*100(100/100) :norm 10.00000>
            #<->WEIGHT (:CLOUD #1=(INPUTS F1)) :SIZE
              392000*1(1/1) :norm 124.81711>
            #<->ACTIVATION (:CLOUD #1# . #2=(:LINEAR)) :SIZE
              500*100(100/100) :norm 944.69777>
            #<->WEIGHT (:CLOUD #3=(C0 F1)) :SIZE
              500*1(1/1) :norm 28.44436>
            #<->ACTIVATION (:CLOUD #3# . #2#) :SIZE
              500*100(100/100) :norm 284.44364>
            #<->+ (:CHUNK F1 . #4=(:ACTIVATION)) :SIZE
              500*100(100/100) :norm 793.13614>
            #<->SIGMOID (:CHUNK F1) :SIZE
              500*100(100/100) :norm 118.12746>
            #<->CONSTANT (:CHUNK C1) :SIZE
              1*100(100/100) :norm 10.00000>
            #<->WEIGHT (:CLOUD #5=(F1 F2)) :SIZE
              250000*1(1/1) :norm 143.39251>
            #<->ACTIVATION (:CLOUD #5# . #2#) :SIZE
              500*100(100/100) :norm 995.21594>
            #<->WEIGHT (:CLOUD #6=(C1 F2)) :SIZE
              500*1(1/1) :norm 4.61589>
            #<->ACTIVATION (:CLOUD #6# . #2#) :SIZE
              500*100(100/100) :norm 46.15887>
            #<->+ (:CHUNK F2 . #4#) :SIZE
              500*100(100/100) :norm 979.23698>
            #<->SIGMOID (:CHUNK F2) :SIZE
              500*100(100/100) :norm 98.13294>
            #<->CONSTANT (:CHUNK C2) :SIZE
              1*100(100/100) :norm 10.00000>
            #<->WEIGHT (:CLOUD #7=(F2 F3)) :SIZE
              1000000*1(1/1) :norm 231.90284>
            #<->ACTIVATION (:CLOUD #7# . #2#) :SIZE
              2000*100(100/100) :norm 3052.13876>
            #<->WEIGHT (:CLOUD #8=(C2 F3)) :SIZE
              2000*1(1/1) :norm 5.88131>
            #<->ACTIVATION (:CLOUD #8# . #2#) :SIZE
              2000*100(100/100) :norm 58.81307>
            #<->+ (:CHUNK F3 . #4#) :SIZE
              2000*100(100/100) :norm 3099.12304>
            #<->SIGMOID #9=(:CHUNK F3) :SIZE
              2000*100(100/100) :norm 116.72581>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.25699>
            #<->WEIGHT #10=(#9# PREDICTIONS) :SIZE
              20000*1(1/1) :norm 35.67565>
            #<->ACTIVATION (#10# :ACTIVATION) :SIZE
              10*100(100/100) :norm 135.34226>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*100(100/100) :norm 135.38445>
            #<->INPUT EXPECTATIONS :SIZE
              10*100(100/100) :norm 10.00000>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*100(100/100) :norm 2.43457>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*100(100/100) :norm 2.43457>)
  N-STRIPES = 100
  MAX-N-STRIPES = 100
2014-10-16 14:12:59: Describing optimizer:
#<MNIST-BPN-GD-OPTIMIZER {1030787AC3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT ((:CHUNK F3) PREDICTIONS) :SIZE
                       20000*1(1/1) :norm 35.67565>)
                    {103078E943}>
                  {103078B353}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                       10*1(1/1) :norm 0.25699>)
                    {103078E1B3}>
                  {103078B233}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (C2 F3)) :SIZE
                       2000*1(1/1) :norm 5.88131>)
                    {103078DA23}>
                  {103078B113}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (F2 F3)) :SIZE
                       1000000*1(1/1) :norm 231.90284>)
                    {103078D293}>
                  {103078AFF3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (C1 F2)) :SIZE
                       500*1(1/1) :norm 4.61589>)
                    {103078CB03}>
                  {103078AED3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (F1 F2)) :SIZE
                       250000*1(1/1) :norm 143.39251>)
                    {103078C373}>
                  {103078ADB3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (C0 F1)) :SIZE
                       500*1(1/1) :norm 28.44436>)
                    {103078BBE3}>
                  {103078AC93}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (INPUTS F1)) :SIZE
                       392000*1(1/1) :norm 124.81711>)
                    {103078B453}>
                  {103078AB73}>)
  SEGMENTS = (#<->WEIGHT ((:CHUNK F3) PREDICTIONS) :SIZE
                20000*1(1/1) :norm 35.67565>
              #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                10*1(1/1) :norm 0.25699>
              #<->WEIGHT (:CLOUD (C2 F3)) :SIZE
                2000*1(1/1) :norm 5.88131>
              #<->WEIGHT (:CLOUD (F2 F3)) :SIZE
                1000000*1(1/1) :norm 231.90284>
              #<->WEIGHT (:CLOUD (C1 F2)) :SIZE
                500*1(1/1) :norm 4.61589>
              #<->WEIGHT (:CLOUD (F1 F2)) :SIZE
                250000*1(1/1) :norm 143.39251>
              #<->WEIGHT (:CLOUD (C0 F1)) :SIZE
                500*1(1/1) :norm 28.44436>
              #<->WEIGHT (:CLOUD (INPUTS F1)) :SIZE
                392000*1(1/1) :norm 124.81711>)

#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {103078B353}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT ((:CHUNK F3) PREDICTIONS) :SIZE
                     20000*1(1/1) :norm 35.67565>)
                  {103078E943}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {103078B233}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.25699>)
                  {103078E1B3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {103078B113}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (C2 F3)) :SIZE
                     2000*1(1/1) :norm 5.88131>)
                  {103078DA23}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {103078AFF3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (F2 F3)) :SIZE
                     1000000*1(1/1) :norm 231.90284>)
                  {103078D293}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {103078AED3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (C1 F2)) :SIZE
                     500*1(1/1) :norm 4.61589>)
                  {103078CB03}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {103078ADB3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (F1 F2)) :SIZE
                     250000*1(1/1) :norm 143.39251>)
                  {103078C373}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {103078AC93}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (C0 F1)) :SIZE
                     500*1(1/1) :norm 28.44436>)
                  {103078BBE3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {103078AB73}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (INPUTS F1)) :SIZE
                     392000*1(1/1) :norm 124.81711>)
                  {103078B453}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:12:59: cuda mats: 70056, copies: h->d: 70817, d->h: 2230
2014-10-16 14:12:59: test at n-instances: 0
2014-10-16 14:13:02: pred. test bpn PREDICTIONS acc.: 93.74% (10000)
2014-10-16 14:13:02: pred. test bpn PREDICTIONS xent: 2.170d-3 (10000)
2014-10-16 14:13:02: cuda mats: 70056, copies: h->d: 70917, d->h: 2430
2014-10-16 14:13:02: ---------------------------------------------------
2014-10-16 14:13:46: training at n-instances: 60000
2014-10-16 14:13:46: train train+ bpn PREDICTIONS acc.: 80.65% (60000)
2014-10-16 14:13:46: train train+ bpn PREDICTIONS xent: 6.293d-3 (60000)
2014-10-16 14:13:46: test at n-instances: 60000
2014-10-16 14:13:49: pred. test bpn PREDICTIONS acc.: 94.37% (10000)
2014-10-16 14:13:49: pred. test bpn PREDICTIONS xent: 1.999d-3 (10000)
2014-10-16 14:13:49: cuda mats: 70091, copies: h->d: 71617, d->h: 4430
2014-10-16 14:13:49: ---------------------------------------------------
2014-10-16 14:14:34: training at n-instances: 120000
2014-10-16 14:14:34: train train+ bpn PREDICTIONS acc.: 85.58% (60000)
2014-10-16 14:14:34: train train+ bpn PREDICTIONS xent: 4.563d-3 (60000)
2014-10-16 14:14:34: test at n-instances: 120000
2014-10-16 14:14:37: pred. test bpn PREDICTIONS acc.: 94.55% (10000)
2014-10-16 14:14:37: pred. test bpn PREDICTIONS xent: 1.846d-3 (10000)
2014-10-16 14:14:37: cuda mats: 70091, copies: h->d: 72317, d->h: 6430
2014-10-16 14:14:37: ---------------------------------------------------
2014-10-16 14:14:37: TRAIN-MNIST/2 :DROPOUTP NIL
2014-10-16 14:14:38: init: #<FULL-CLOUD (INPUTS F1) :NORM 6.25386d+0> 0.001
2014-10-16 14:14:38: init: #<FULL-CLOUD (F1 F2) :NORM 7.07140d+0> 0.01
2014-10-16 14:14:38: init: #<FULL-CLOUD (LABEL F2) :NORM 1.00568d+0> 0.01
2014-10-16 14:14:38: Starting to train level 0 RBM in DBN.
2014-10-16 14:14:38: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {1028278B93}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM/2 (C0 INPUTS) - (C1 F1)>
  MONITORS                   = (#<MONITOR train train+ rbm INPUTS rmse: 0.000e+0 (0)>)
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = T
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 1
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {10282774A3}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = T
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 1

#<MNIST-RBM/2 {101DE466B3}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C0 1(1/100)>
                    #<SIGMOID-CHUNK INPUTS 784(1/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C1 1(1/100)>
                   #<SIGMOID-CHUNK F1 500(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>
            #<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>
            #<FULL-CLOUD (INPUTS F1) :NORM 6.25445d-1>)
  N-STRIPES = 1
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN {101DEB85C3}>

2014-10-16 14:14:38: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {10282774A3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d-1>)
                    {102827AD73}>
                  {10282798A3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>)
                    {102827A5E3}>
                  {10282797B3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)
                    {1028279993}>
                  {10282796C3}>)
  SEGMENTS = (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d-1>
              #<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>
              #<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {10282798A3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d-1>)
                  {102827AD73}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 1.00000d-3
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {10282797B3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>)
                  {102827A5E3}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {10282796C3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)
                  {1028279993}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:14:38: cuda mats: 8, copies: h->d: 0, d->h: 3
2014-10-16 14:14:38: test at n-instances: 0
2014-10-16 14:14:40: pred. test+ dbn l0, rbm INPUTS rmse: 4.812d-1 (7840000)
2014-10-16 14:14:40: cuda mats: 10022, copies: h->d: 10003, d->h: 3
2014-10-16 14:14:40: ---------------------------------------------------
2014-10-16 14:14:58: training at n-instances: 60000
2014-10-16 14:14:58: train train+ rbm INPUTS rmse: 3.123d-1 (47040000)
2014-10-16 14:14:58: test at n-instances: 60000
2014-10-16 14:14:59: pred. test+ dbn l0, rbm INPUTS rmse: 1.190d-1 (7840000)
2014-10-16 14:14:59: cuda mats: 70030, copies: h->d: 70003, d->h: 3
2014-10-16 14:14:59: ---------------------------------------------------
2014-10-16 14:15:16: training at n-instances: 120000
2014-10-16 14:15:16: train train+ rbm INPUTS rmse: 2.567d-1 (47040000)
2014-10-16 14:15:16: test at n-instances: 120000
2014-10-16 14:15:17: pred. test+ dbn l0, rbm INPUTS rmse: 9.815d-2 (7840000)
2014-10-16 14:15:17: cuda mats: 70030, copies: h->d: 70003, d->h: 3
2014-10-16 14:15:17: ---------------------------------------------------
2014-10-16 14:15:17: Starting to train level 1 RBM in DBN.
2014-10-16 14:15:17: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {101CB71103}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM/2 (C1 F1 LABEL) - (C2 F2)>
  MONITORS                   = (#<MONITOR #1=train #2=train+ #3=rbm F1 #4=rmse: 0.000e+0 (0)>..
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = T
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = #<CLOSURE (LAMBDA (OPTIMIZER) :IN TRAIN-MNIST/2) {102827199B}>
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {101CB6EEA3}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = T
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = "#<error printing object>"

#<MNIST-RBM/2 {1028AD31E3}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C1 1(100/100)>
                    #<SIGMOID-CHUNK F1 500(100/100)>
                    #<SOFTMAX-LABEL-CHUNK LABEL 10(1/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C2 1(1/100)>
                   #<SIGMOID-CHUNK F2 1000(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>
            #<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>
            #<FULL-CLOUD (F1 F2) :NORM 7.07103d+0>
            #<FULL-CLOUD (LABEL C2) :NORM 0.00000d+0>
            #<FULL-CLOUD (LABEL F2) :NORM 9.97621d-1>)
  N-STRIPES = 100
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN {101DEB85C3}>

2014-10-16 14:15:17: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {101CB6EEA3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (LABEL F2) :NORM 9.97621d-1>)
                    {101CB739E3}>
                  {101CB71AB3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (LABEL C2) :NORM 0.00000d+0>)
                    {101CB73253}>
                  {101CB719C3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 F2) :NORM 7.07103d+0>)
                    {101CB72AC3}>
                  {101CB718D3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>)
                    {101CB72333}>
                  {101CB717E3}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)
                    {101CB71BA3}>
                  {101CB716F3}>)
  SEGMENTS = (#<FULL-CLOUD (LABEL F2) :NORM 9.97621d-1>
              #<FULL-CLOUD (LABEL C2) :NORM 0.00000d+0>
              #<FULL-CLOUD (F1 F2) :NORM 7.07103d+0>
              #<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>
              #<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {101CB71AB3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (LABEL F2) :NORM 9.97621d-1>)
                  {101CB739E3}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 1.00000d-3
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {101CB719C3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (LABEL C2) :NORM 0.00000d+0>)
                  {101CB73253}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {101CB718D3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 F2) :NORM 7.07103d+0>)
                  {101CB72AC3}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 1.00000d-3
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {101CB717E3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>)
                  {101CB72333}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {101CB716F3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)
                  {101CB71BA3}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:15:17: cuda mats: 70030, copies: h->d: 70003, d->h: 8
2014-10-16 14:15:17: test at n-instances: 0
2014-10-16 14:15:24: pred. train+ dbn l1, rbm LABEL  acc.: 9.40% (1000)
2014-10-16 14:15:24: pred. train+ dbn l1, rbm LABEL  xent: 2.296d-2 (1000)
2014-10-16 14:15:24: pred. train  dbn l1, rbm LABEL  acc.: 9.40% (1000)
2014-10-16 14:15:24: pred. train  dbn l1, rbm LABEL  xent: 2.318d-2 (1000)
2014-10-16 14:15:24: pred. test+  dbn l0, rbm INPUTS rmse: 3.306d-1 (7840000)
2014-10-16 14:15:24: pred. test+  dbn l1, rbm F1     rmse: 4.331d-1 (5000000)
2014-10-16 14:15:24: pred. test+  dbn l1, rbm LABEL  rmse: 2.999d-1 (100000)
2014-10-16 14:15:24: pred. test   dbn l1, rbm LABEL  acc.: 9.58% (10000)
2014-10-16 14:15:24: pred. test   dbn l1, rbm LABEL  xent: 2.321d-2 (10000)
2014-10-16 14:15:24: cuda mats: 70048, copies: h->d: 70224, d->h: 12570
2014-10-16 14:15:24: ---------------------------------------------------
2014-10-16 14:15:51: training at n-instances: 60000
2014-10-16 14:15:51: train train+ rbm F1    rmse: 4.536d-1 (30000000)
2014-10-16 14:15:51: train train+ rbm LABEL rmse: 2.562d-1 (600000)
2014-10-16 14:15:51: train train+ rbm LABEL acc.: 67.19% (60000)
2014-10-16 14:15:51: train train+ rbm LABEL xent: 1.133d-1 (60000)
2014-10-16 14:15:51: test at n-instances: 60000
2014-10-16 14:15:57: pred. train+ dbn l1, rbm LABEL  acc.: 91.30% (1000)
2014-10-16 14:15:57: pred. train+ dbn l1, rbm LABEL  xent: 2.887d-3 (1000)
2014-10-16 14:15:57: pred. train  dbn l1, rbm LABEL  acc.: 89.70% (1000)
2014-10-16 14:15:57: pred. train  dbn l1, rbm LABEL  xent: 3.590d-3 (1000)
2014-10-16 14:15:57: pred. test+  dbn l0, rbm INPUTS rmse: 1.190d-1 (7840000)
2014-10-16 14:15:57: pred. test+  dbn l1, rbm F1     rmse: 1.071d-1 (5000000)
2014-10-16 14:15:57: pred. test+  dbn l1, rbm LABEL  rmse: 1.061d-1 (100000)
2014-10-16 14:15:57: pred. test   dbn l1, rbm LABEL  acc.: 91.02% (10000)
2014-10-16 14:15:57: pred. test   dbn l1, rbm LABEL  xent: 3.266d-3 (10000)
2014-10-16 14:15:57: cuda mats: 70060, copies: h->d: 71044, d->h: 86333
2014-10-16 14:15:57: ---------------------------------------------------
2014-10-16 14:16:24: training at n-instances: 120000
2014-10-16 14:16:24: train train+ rbm F1    rmse: 3.968d-1 (30000000)
2014-10-16 14:16:24: train train+ rbm LABEL rmse: 1.849d-1 (600000)
2014-10-16 14:16:24: train train+ rbm LABEL acc.: 82.91% (60000)
2014-10-16 14:16:24: train train+ rbm LABEL xent: 5.903d-2 (60000)
2014-10-16 14:16:24: test at n-instances: 120000
2014-10-16 14:16:31: pred. train+ dbn l1, rbm LABEL  acc.: 94.20% (1000)
2014-10-16 14:16:31: pred. train+ dbn l1, rbm LABEL  xent: 2.120d-3 (1000)
2014-10-16 14:16:31: pred. train  dbn l1, rbm LABEL  acc.: 92.10% (1000)
2014-10-16 14:16:31: pred. train  dbn l1, rbm LABEL  xent: 2.784d-3 (1000)
2014-10-16 14:16:31: pred. test+  dbn l0, rbm INPUTS rmse: 1.150d-1 (7840000)
2014-10-16 14:16:31: pred. test+  dbn l1, rbm F1     rmse: 8.911d-2 (5000000)
2014-10-16 14:16:31: pred. test+  dbn l1, rbm LABEL  rmse: 8.815d-2 (100000)
2014-10-16 14:16:31: pred. test   dbn l1, rbm LABEL  acc.: 93.46% (10000)
2014-10-16 14:16:31: pred. test   dbn l1, rbm LABEL  xent: 2.523d-3 (10000)
2014-10-16 14:16:31: cuda mats: 70060, copies: h->d: 71864, d->h: 160096
2014-10-16 14:16:31: ---------------------------------------------------
2014-10-16 14:16:31: Starting to train DBM.
2014-10-16 14:16:32: Describing gradient source:
#<BM-PCD-LEARNER {1013F9F043}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-DBM (C0 INPUTS LABEL) - (C1 F1 C2 F2)>
  MONITORS                   = (#<MONITOR #1=train #2=train+ #3=dbm INPUTS #4=rmse: 0.000e+0 (0)>..
  SPARSITY-GRADIENT-SOURCES  = (#<CHEATING-SPARSITY-GRADIENT-SOURCE (C0 F1) F1 {1014879C13}>..
  SPARSER                    = #<FUNCTION (LAMBDA (CLOUD CHUNK) :IN TRAIN-MNIST-DBM) {10054555BB}>
  VISIBLE-SAMPLING           = T
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 5
  N-PARTICLES                = 100
  PERSISTENT-CHAINS          = #<MNIST-DBM (C0 INPUTS LABEL) - (C1 F1 C2 F2)>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = (#<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 (C0 F1) F1 {1014879C13}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 (INPUTS F1) F1 {101487E173}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 (C1 F2) F2 {101487F5C3}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 (F1 C2) F1 {1014880813}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 #1=(F1 F2) F1 {1014881A03}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE #1#
                                 F2 {1014882BF3}>)

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = T
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 5

BM-PCD-LEARNER description:
  N-PARTICLES = 100

#<MNIST-DBM {102FEACE53}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C0 1(1/100)>
                    #<SIGMOID-CHUNK INPUTS 784(1/100)>
                    #<SOFTMAX-LABEL-CHUNK LABEL 10(1/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C1 1(1/100)>
                   #<SIGMOID-CHUNK F1 500(1/100)>
                   #<CONSTANT-CHUNK C2 1(1/100)>
                   #<SIGMOID-CHUNK F2 1000(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>
            #<FULL-CLOUD (INPUTS C1) :NORM 5.53860d+0>
            #<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>
            #<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>
            #<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>
            #<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>
            #<FULL-CLOUD (LABEL C2) :NORM 8.66429d-2>
            #<FULL-CLOUD (LABEL F2) :NORM 7.37013d+0>)
  N-STRIPES = 1
  MAX-N-STRIPES = 100

#<CHEATING-SPARSITY-GRADIENT-SOURCE {1014879C13}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>
  CHUNK = #<SIGMOID-CHUNK F1 500(1/100)>
  TARGET = 2.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {101487E173}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>
  CHUNK = #<SIGMOID-CHUNK F1 500(1/100)>
  TARGET = 2.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {101487F5C3}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>
  CHUNK = #<SIGMOID-CHUNK F2 1000(1/100)>
  TARGET = 1.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {1014880813}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>
  CHUNK = #<SIGMOID-CHUNK F1 500(1/100)>
  TARGET = 2.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {1014881A03}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>
  CHUNK = #<SIGMOID-CHUNK F1 500(1/100)>
  TARGET = 2.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {1014882BF3}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>
  CHUNK = #<SIGMOID-CHUNK F2 1000(1/100)>
  TARGET = 1.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
2014-10-16 14:16:32: Describing optimizer:
#<MNIST-DBM-OPTIMIZER {1013E81EE3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (LABEL F2) :NORM 7.37013d+0>)
                    {101422B573}>
                  {1014226EE3}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (LABEL C2) :NORM 8.66429d-2>)
                    {101422ADE3}>
                  {1014226DF3}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>)
                    {101422A653}>
                  {1014226D03}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>)
                    {1014229EC3}>
                  {1014226C13}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>)
                    {1014229733}>
                  {1014226B23}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>)
                    {1014228FA3}>
                  {1014226A33}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS C1) :NORM 5.53860d+0>)
                    {1014228813}>
                  {1014226943}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>)
                    {1014227433}>
                  {1014226853}>)
  SEGMENTS = (#<FULL-CLOUD (LABEL F2) :NORM 7.37013d+0>
              #<FULL-CLOUD (LABEL C2) :NORM 8.66429d-2>
              #<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>
              #<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>
              #<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>
              #<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>
              #<FULL-CLOUD (INPUTS C1) :NORM 5.53860d+0>
              #<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>)

#<MNIST-DBM-SEGMENT-OPTIMIZER {1005CF9193}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (LABEL F2) :NORM 7.37013d+0>)
                  {101422B573}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {1005CF9163}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (LABEL C2) :NORM 8.66429d-2>)
                  {101422ADE3}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {1005CF9133}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>)
                  {101422A653}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {1005CF9103}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>)
                  {1014229EC3}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {1005CF90D3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>)
                  {1014229733}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {1005CF90A3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>)
                  {1014228FA3}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {1005CF9073}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS C1) :NORM 5.53860d+0>)
                  {1014228813}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {1005CF9043}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>)
                  {1005CFA473}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:16:32: cuda mats: 135, copies: h->d: 106, d->h: 1
2014-10-16 14:16:32: test at n-instances: 0
2014-10-16 14:17:12: pred. train+ dbm LABEL acc.: 100.00% (1000)
2014-10-16 14:17:12: pred. train+ dbm LABEL xent: 0.000d+0 (1000)
2014-10-16 14:17:12: pred. train  dbm LABEL acc.: 9.70% (1000)
2014-10-16 14:17:12: pred. train  dbm LABEL xent: 3.454d-1 (1000)
2014-10-16 14:17:12: pred. test   dbm LABEL acc.: 9.80% (10000)
2014-10-16 14:17:12: pred. test   dbm LABEL xent: 3.454d-1 (10000)
2014-10-16 14:17:12: cuda mats: 11159, copies: h->d: 11230, d->h: 1233
2014-10-16 14:17:12: ---------------------------------------------------
2014-10-16 14:22:00: training at n-instances: 60000
2014-10-16 14:22:00: train train+ dbm INPUTS rmse: 1.659d-1 (47040000)
2014-10-16 14:22:00: train train+ dbm LABEL  rmse: 8.502d-2 (600000)
2014-10-16 14:22:00: train train+ dbm LABEL  acc.: 95.72% (60000)
2014-10-16 14:22:00: train train+ dbm LABEL  xent: 1.744d-3 (60000)
2014-10-16 14:22:00: test at n-instances: 60000
2014-10-16 14:22:36: pred. train+ dbm LABEL acc.: 100.00% (1000)
2014-10-16 14:22:36: pred. train+ dbm LABEL xent: 0.000d+0 (1000)
2014-10-16 14:22:36: pred. train  dbm LABEL acc.: 9.70% (1000)
2014-10-16 14:22:36: pred. train  dbm LABEL xent: 3.454d-1 (1000)
2014-10-16 14:22:36: pred. test   dbm LABEL acc.: 9.80% (10000)
2014-10-16 14:22:36: pred. test   dbm LABEL xent: 3.454d-1 (10000)
2014-10-16 14:22:36: cuda mats: 70109, copies: h->d: 70854, d->h: 63666
2014-10-16 14:22:36: ---------------------------------------------------
2014-10-16 14:22:37: inits:
((:CLOUD-NAME (C1 F2) :WEIGHT-NAME (:CLOUD (C1 F2)))
 (:CLOUD-NAME (F1 F2) :WEIGHT-NAME (:CLOUD (F1 F2)))
 (:CLOUD-NAME (C0 F1) :WEIGHT-NAME (:CLOUD (C0 F1)))
 (:CLOUD-NAME (INPUTS F1) :WEIGHT-NAME (:CLOUD (INPUTS F1)))
 (:CLOUD-NAME (F1 C2) :WEIGHT-NAME (:CLOUD (F1 C2) :TRANSPOSE))
 (:CLOUD-NAME (F1 F2) :WEIGHT-NAME (:CLOUD (F1 F2) :TRANSPOSE)))
2014-10-16 14:22:37: bpn def:
(BUILD-BPN (:CLASS 'MNIST-BPN/2 :MAX-N-STRIPES 1000 :INITARGS
            '(:POPULATE-KEY #<FUNCTION FIRST>
              :POPULATE-CONVERT-TO-DBM-SAMPLE-FN
              #<FUNCTION (LAMBDA (SAMPLE) :IN TRAIN-MNIST/2) {1048A2147B}>
              :POPULATE-MAP-CACHE-LAZILY-FROM-DBM
              #<MNIST-DBM (C0 INPUTS LABEL) - (C1 F1 C2 F2)>
              :POPULATE-PERIODIC-FN #<PERIODIC-FN {1028B82F33}>))
  (#:G161178 (->INPUT :NAME '(:CHUNK F2 :MAP) :SIZE 1000))
  (#:G161177 (->CONSTANT :NAME '(:CHUNK C2 :MAP) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G161174 (->INPUT :NAME '(:CHUNK INPUTS) :SIZE 784))
  (#:G161172 (->CONSTANT :NAME '(:CHUNK C0) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G161175 (->CONSTANT :NAME '(:CHUNK C1) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G161185 (->WEIGHT :NAME '(:CLOUD (F1 F2) :TRANSPOSE) :SIZE 500000))
  (#:G161186
   (->ACTIVATION :NAME '(:CLOUD (F1 F2) :TRANSPOSE :LINEAR) :SIZE 500 :WEIGHTS
                 #:G161185 :X #:G161178 :TRANSPOSE-WEIGHTS-P T))
  (#:G161187 (->WEIGHT :NAME '(:CLOUD (F1 C2) :TRANSPOSE) :SIZE 500))
  (#:G161188
   (->ACTIVATION :NAME '(:CLOUD (F1 C2) :TRANSPOSE :LINEAR) :SIZE 500 :WEIGHTS
                 #:G161187 :X #:G161177 :TRANSPOSE-WEIGHTS-P T))
  (#:G161189 (->WEIGHT :NAME '(:CLOUD (INPUTS F1)) :SIZE 392000))
  (#:G161190
   (->ACTIVATION :NAME '(:CLOUD (INPUTS F1) :LINEAR) :SIZE 500 :WEIGHTS
                 #:G161189 :X #:G161174 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G161191 (->WEIGHT :NAME '(:CLOUD (C0 F1)) :SIZE 500))
  (#:G161192
   (->ACTIVATION :NAME '(:CLOUD (C0 F1) :LINEAR) :SIZE 500 :WEIGHTS #:G161191
                 :X #:G161172 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G161184
   (->+ :NAME '(:CHUNK F1 :ACTIVATION) :ARGS
        (LIST #:G161186 #:G161188 #:G161190 #:G161192)))
  (#:G161173 (->SIGMOID :NAME '(:CHUNK F1) :X #:G161184))
  (#:G161194 (->WEIGHT :NAME '(:CLOUD (F1 F2)) :SIZE 500000))
  (#:G161195
   (->ACTIVATION :NAME '(:CLOUD (F1 F2) :LINEAR) :SIZE 1000 :WEIGHTS #:G161194
                 :X #:G161173 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G161196 (->WEIGHT :NAME '(:CLOUD (C1 F2)) :SIZE 1000))
  (#:G161197
   (->ACTIVATION :NAME '(:CLOUD (C1 F2) :LINEAR) :SIZE 1000 :WEIGHTS #:G161196
                 :X #:G161175 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G161193
   (->+ :NAME '(:CHUNK F2 :ACTIVATION) :ARGS (LIST #:G161195 #:G161197)))
  (#:G161176 (->SIGMOID :NAME '(:CHUNK F2) :X #:G161193)))
2014-10-16 14:22:37: Starting to train the softmax layer of BPN
2014-10-16 14:22:37: Describing gradient source:
#<BP-LEARNER {1028D15F23}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN/2 :N-STRIPES 1 :MAX-N-STRIPES 1000 {1028CE9A93}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = NIL

BP-LEARNER description:
  BPN = #<MNIST-BPN/2 :N-STRIPES 1 :MAX-N-STRIPES 1000 {1028CE9A93}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN/2 {1028CE9A93}>
BPN description:
  LUMPS = #(#<->INPUT (:CHUNK F2 :MAP) :SIZE
              1000*1(1/1000) :norm 0.00000>
            #<->CONSTANT (:CHUNK C2 :MAP) :SIZE
              1*1(1/1000) :norm 1.00000>
            #<->INPUT (:CHUNK INPUTS) :SIZE
              784*1(1/1000) :norm 0.00000>
            #<->CONSTANT (:CHUNK C0) :SIZE 1*1(1/1000) :norm 1.00000>
            #<->CONSTANT (:CHUNK C1) :SIZE 1*1(1/1000) :norm 1.00000>
            #<->WEIGHT (:CLOUD #1=(F1 F2) . #2=(:TRANSPOSE)) :SIZE
              500000*1(1/1) :norm 41.67080>
            #<->ACTIVATION (:CLOUD #1# :TRANSPOSE . #3=(:LINEAR)) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:CLOUD #4=(F1 C2) . #2#) :SIZE
              500*1(1/1) :norm 2.61410>
            #<->ACTIVATION (:CLOUD #4# :TRANSPOSE . #3#) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:CLOUD #5=(INPUTS F1)) :SIZE
              392000*1(1/1) :norm 54.93184>
            #<->ACTIVATION (:CLOUD #5# . #3#) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:CLOUD #6=(C0 F1)) :SIZE
              500*1(1/1) :norm 19.13846>
            #<->ACTIVATION (:CLOUD #6# . #3#) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->+ (:CHUNK F1 . #7=(:ACTIVATION)) :SIZE
              500*1(1/1000) :norm 0.00000>
            #<->SIGMOID (:CHUNK F1) :SIZE 500*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:CLOUD #1#) :SIZE 500000*1(1/1) :norm 41.67080>
            #<->ACTIVATION (:CLOUD #1# . #3#) :SIZE
              1000*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:CLOUD #8=(C1 F2)) :SIZE
              1000*1(1/1) :norm 9.38955>
            #<->ACTIVATION (:CLOUD #8# . #3#) :SIZE
              1000*1(1/1000) :norm 0.00000>
            #<->+ (:CHUNK F2 . #7#) :SIZE 1000*1(1/1000) :norm 0.00000>
            #<->SIGMOID #9=(:CHUNK F2) :SIZE
              1000*1(1/1000) :norm 0.00000>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.08687>
            #<->WEIGHT #10=(#9# PREDICTIONS) :SIZE
              10000*1(1/1) :norm 7.42471>
            #<->ACTIVATION (#10# :ACTIVATION) :SIZE
              10*1(1/1000) :norm 0.00000>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1(1/1000) :norm 0.00000>
            #<->INPUT EXPECTATIONS :SIZE 10*1(1/1000) :norm 0.00000>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1(1/1000) :norm 0.00000>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1(1/1000) :norm 0.00000>)
  N-STRIPES = 1
  MAX-N-STRIPES = 1000
2014-10-16 14:22:37: Describing optimizer:
#<MNIST-CG-BP-OPTIMIZER {1028D15CC3}>
CG-OPTIMIZER description:
  N-INSTANCES = 0
  BATCH-SIZE = 10000
  CG-ARGS = (:MAX-N-LINE-SEARCHES 3)
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.08687>
                   #<->WEIGHT ((:CHUNK F2) PREDICTIONS) :SIZE
                     10000*1(1/1) :norm 7.42471>)
                  {1028D163C3}>
2014-10-16 14:22:37: cuda mats: 16, copies: h->d: 7, d->h: 8
2014-10-16 14:22:37: test at n-instances: 0
2014-10-16 14:22:37: populated: 0
2014-10-16 14:22:40: populated: 1000
2014-10-16 14:22:43: populated: 2000
2014-10-16 14:22:46: populated: 3000
2014-10-16 14:22:50: populated: 4000
2014-10-16 14:22:53: populated: 5000
2014-10-16 14:22:56: populated: 6000
2014-10-16 14:23:00: populated: 7000
2014-10-16 14:23:03: populated: 8000
2014-10-16 14:23:06: populated: 9000
2014-10-16 14:23:09: populated: 10000
2014-10-16 14:23:10: pred. test bpn PREDICTIONS acc.: 93.76% (10000)
2014-10-16 14:23:10: pred. test bpn PREDICTIONS xent: 2.464d-4 (10000)
2014-10-16 14:23:10: cuda mats: 20060, copies: h->d: 10133, d->h: 228
2014-10-16 14:23:10: ---------------------------------------------------
2014-10-16 14:23:13: populated: 11000
2014-10-16 14:23:16: populated: 12000
2014-10-16 14:23:19: populated: 13000
2014-10-16 14:23:23: populated: 14000
2014-10-16 14:23:26: populated: 15000
2014-10-16 14:23:29: populated: 16000
2014-10-16 14:23:32: populated: 17000
2014-10-16 14:23:36: populated: 18000
2014-10-16 14:23:39: populated: 19000
2014-10-16 14:23:42: populated: 20000
2014-10-16 14:24:00: n-instances: 0
2014-10-16 14:24:00: best-f: 2.36919d+3 (10000), n-evaluations: 11
2014-10-16 14:24:00: n-line-searches: 3 (succesful 3)
2014-10-16 14:24:03: populated: 21000
2014-10-16 14:24:06: populated: 22000
2014-10-16 14:24:10: populated: 23000
2014-10-16 14:24:13: populated: 24000
2014-10-16 14:24:16: populated: 25000
2014-10-16 14:24:19: populated: 26000
2014-10-16 14:24:23: populated: 27000
2014-10-16 14:24:26: populated: 28000
2014-10-16 14:24:29: populated: 29000
2014-10-16 14:24:32: populated: 30000
2014-10-16 14:24:50: n-instances: 10000
2014-10-16 14:24:50: best-f: 2.27986d+3 (10000), n-evaluations: 11
2014-10-16 14:24:50: n-line-searches: 3 (succesful 3)
2014-10-16 14:24:53: populated: 31000
2014-10-16 14:24:57: populated: 32000
2014-10-16 14:25:00: populated: 33000
2014-10-16 14:25:03: populated: 34000
2014-10-16 14:25:06: populated: 35000
2014-10-16 14:25:10: populated: 36000
2014-10-16 14:25:13: populated: 37000
2014-10-16 14:25:16: populated: 38000
2014-10-16 14:25:20: populated: 39000
2014-10-16 14:25:23: populated: 40000
2014-10-16 14:25:39: n-instances: 20000
2014-10-16 14:25:39: best-f: 2.35132d+3 (10000), n-evaluations: 10
2014-10-16 14:25:39: n-line-searches: 3 (succesful 3)
2014-10-16 14:25:42: populated: 41000
2014-10-16 14:25:45: populated: 42000
2014-10-16 14:25:48: populated: 43000
2014-10-16 14:25:52: populated: 44000
2014-10-16 14:25:55: populated: 45000
2014-10-16 14:25:58: populated: 46000
2014-10-16 14:26:02: populated: 47000
2014-10-16 14:26:05: populated: 48000
2014-10-16 14:26:08: populated: 49000
2014-10-16 14:26:11: populated: 50000
2014-10-16 14:26:27: n-instances: 30000
2014-10-16 14:26:27: best-f: 2.24357d+3 (10000), n-evaluations: 10
2014-10-16 14:26:27: n-line-searches: 3 (succesful 3)
2014-10-16 14:26:30: populated: 51000
2014-10-16 14:26:34: populated: 52000
2014-10-16 14:26:37: populated: 53000
2014-10-16 14:26:40: populated: 54000
2014-10-16 14:26:43: populated: 55000
2014-10-16 14:26:47: populated: 56000
2014-10-16 14:26:50: populated: 57000
2014-10-16 14:26:53: populated: 58000
2014-10-16 14:26:57: populated: 59000
2014-10-16 14:27:00: populated: 60000
2014-10-16 14:27:16: n-instances: 40000
2014-10-16 14:27:16: best-f: 2.10577d+3 (10000), n-evaluations: 10
2014-10-16 14:27:16: n-line-searches: 3 (succesful 3)
2014-10-16 14:27:20: populated: 61000
2014-10-16 14:27:23: populated: 62000
2014-10-16 14:27:26: populated: 63000
2014-10-16 14:27:29: populated: 64000
2014-10-16 14:27:33: populated: 65000
2014-10-16 14:27:36: populated: 66000
2014-10-16 14:27:39: populated: 67000
2014-10-16 14:27:42: populated: 68000
2014-10-16 14:27:46: populated: 69000
2014-10-16 14:27:49: populated: 70000
2014-10-16 14:28:05: n-instances: 50000
2014-10-16 14:28:05: best-f: 2.12523d+3 (10000), n-evaluations: 10
2014-10-16 14:28:05: n-line-searches: 3 (succesful 3)
2014-10-16 14:28:05: test at n-instances: 60000
2014-10-16 14:28:07: pred. test bpn PREDICTIONS acc.: 94.38% (10000)
2014-10-16 14:28:07: pred. test bpn PREDICTIONS xent: 2.073d-4 (10000)
2014-10-16 14:28:07: cuda mats: 140081, copies: h->d: 71363, d->h: 2688
2014-10-16 14:28:07: ---------------------------------------------------
2014-10-16 14:28:07: Starting to train the whole BPN
2014-10-16 14:28:07: Describing gradient source:
#<BP-LEARNER {104567B723}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN/2 :N-STRIPES 1000 :MAX-N-STRIPES 1000 {1028CE9A93}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = NIL

BP-LEARNER description:
  BPN = #<MNIST-BPN/2 :N-STRIPES 1000 :MAX-N-STRIPES 1000 {1028CE9A93}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN/2 {1028CE9A93}>
BPN description:
  LUMPS = #(#<->INPUT (:CHUNK F2 :MAP) :SIZE
              1000*1000(1000/1000) :norm 313.38298>
            #<->CONSTANT (:CHUNK C2 :MAP) :SIZE
              1*1000(1000/1000) :norm 31.62278>
            #<->INPUT (:CHUNK INPUTS) :SIZE
              784*1000(1000/1000) :norm 298.81957>
            #<->CONSTANT (:CHUNK C0) :SIZE
              1*1000(1000/1000) :norm 31.62278>
            #<->CONSTANT (:CHUNK C1) :SIZE
              1*1000(1000/1000) :norm 31.62278>
            #<->WEIGHT (:CLOUD #1=(F1 F2) . #2=(:TRANSPOSE)) :SIZE
              500000*1(1/1) :norm 41.67080>
            #<->ACTIVATION (:CLOUD #1# :TRANSPOSE . #3=(:LINEAR)) :SIZE
              500*1000(1000/1000) :norm 1719.02638>
            #<->WEIGHT (:CLOUD #4=(F1 C2) . #2#) :SIZE
              500*1(1/1) :norm 2.61410>
            #<->ACTIVATION (:CLOUD #4# :TRANSPOSE . #3#) :SIZE
              500*1000(1000/1000) :norm 82.66498>
            #<->WEIGHT (:CLOUD #5=(INPUTS F1)) :SIZE
              392000*1(1/1) :norm 54.93184>
            #<->ACTIVATION (:CLOUD #5# . #3#) :SIZE
              500*1000(1000/1000) :norm 2412.15122>
            #<->WEIGHT (:CLOUD #6=(C0 F1)) :SIZE
              500*1(1/1) :norm 19.13846>
            #<->ACTIVATION (:CLOUD #6# . #3#) :SIZE
              500*1000(1000/1000) :norm 605.21126>
            #<->+ (:CHUNK F1 . #7=(:ACTIVATION)) :SIZE
              500*1000(1000/1000) :norm 3748.67689>
            #<->SIGMOID (:CHUNK F1) :SIZE
              500*1000(1000/1000) :norm 371.92516>
            #<->WEIGHT (:CLOUD #1#) :SIZE 500000*1(1/1) :norm 41.67080>
            #<->ACTIVATION (:CLOUD #1# . #3#) :SIZE
              1000*1000(1000/1000) :norm 3138.26274>
            #<->WEIGHT (:CLOUD #8=(C1 F2)) :SIZE
              1000*1(1/1) :norm 9.38955>
            #<->ACTIVATION (:CLOUD #8# . #3#) :SIZE
              1000*1000(1000/1000) :norm 296.92368>
            #<->+ (:CHUNK F2 . #7#) :SIZE
              1000*1000(1000/1000) :norm 3338.57382>
            #<->SIGMOID #9=(:CHUNK F2) :SIZE
              1000*1000(1000/1000) :norm 313.38298>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.12093>
            #<->WEIGHT #10=(#9# PREDICTIONS) :SIZE
              10000*1(1/1) :norm 8.45615>
            #<->ACTIVATION (#10# :ACTIVATION) :SIZE
              10*1000(1000/1000) :norm 583.90855>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1000(1000/1000) :norm 583.67491>
            #<->INPUT EXPECTATIONS :SIZE
              10*1000(1000/1000) :norm 31.62278>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1000(1000/1000) :norm 17.09256>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1000(1000/1000) :norm 17.09256>)
  N-STRIPES = 1000
  MAX-N-STRIPES = 1000
2014-10-16 14:28:07: Describing optimizer:
#<MNIST-CG-BP-OPTIMIZER {104567B4A3}>
CG-OPTIMIZER description:
  N-INSTANCES = 0
  BATCH-SIZE = 10000
  CG-ARGS = (:MAX-N-LINE-SEARCHES 3)
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD #1=(F1 F2) . #2=(:TRANSPOSE))
                     :SIZE 500000*1(1/1) :norm 41.67080>
                   #<->WEIGHT (:CLOUD (F1 C2) . #2#) :SIZE
                     500*1(1/1) :norm 2.61410>
                   #<->WEIGHT (:CLOUD (INPUTS F1)) :SIZE
                     392000*1(1/1) :norm 54.93184>
                   #<->WEIGHT (:CLOUD (C0 F1)) :SIZE
                     500*1(1/1) :norm 19.13846>
                   #<->WEIGHT (:CLOUD #1#) :SIZE
                     500000*1(1/1) :norm 41.67080>
                   #<->WEIGHT (:CLOUD (C1 F2)) :SIZE
                     1000*1(1/1) :norm 9.38955>
                   #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.12093>
                   #<->WEIGHT ((:CHUNK F2) PREDICTIONS) :SIZE
                     10000*1(1/1) :norm 8.45615>)
                  {104567BA23}>
2014-10-16 14:28:07: cuda mats: 140081, copies: h->d: 71363, d->h: 2706
2014-10-16 14:28:07: test at n-instances: 0
2014-10-16 14:28:09: pred. test bpn PREDICTIONS acc.: 94.38% (10000)
2014-10-16 14:28:09: pred. test bpn PREDICTIONS xent: 2.073d-4 (10000)
2014-10-16 14:28:09: cuda mats: 140081, copies: h->d: 71373, d->h: 2726
2014-10-16 14:28:09: ---------------------------------------------------
2014-10-16 14:28:13: TRAIN-MNIST/2 :DROPOUTP T
2014-10-16 14:28:13: init: #<FULL-CLOUD (INPUTS F1) :NORM 6.25386d+0> 0.001
2014-10-16 14:28:13: init: #<FULL-CLOUD (F1 F2) :NORM 7.07140d+0> 0.01
2014-10-16 14:28:13: init: #<FULL-CLOUD (LABEL F2) :NORM 1.00568d+0> 0.01
2014-10-16 14:28:13: Starting to train level 0 RBM in DBN.
2014-10-16 14:28:13: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {104363BA93}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM/2 (C0 INPUTS) - (C1 F1)>
  MONITORS                   = (#<MONITOR train train+ rbm INPUTS rmse: 0.000e+0 (0)>)
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = T
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 1
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {104363AE83}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = T
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 1

#<MNIST-RBM/2 {10307C9BB3}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C0 1(1/100)>
                    #<SIGMOID-CHUNK INPUTS 784(1/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C1 1(1/100)>
                   #<SIGMOID-CHUNK F1 500(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>
            #<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>
            #<FULL-CLOUD (INPUTS F1) :NORM 6.25445d-1>)
  N-STRIPES = 1
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN {10307DA463}>

2014-10-16 14:28:13: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {104363AE83}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d-1>)
                    {104363D423}>
                  {104363C413}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>)
                    {104363CC93}>
                  {104363C323}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)
                    {104363C503}>
                  {104363C233}>)
  SEGMENTS = (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d-1>
              #<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>
              #<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {104363C413}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS F1) :NORM 6.25445d-1>)
                  {104363D423}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 1.00000d-3
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {104363C323}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS C1) :NORM 0.00000d+0>)
                  {104363CC93}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {104363C233}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C0 F1) :NORM 0.00000d+0>)
                  {104363C503}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:28:13: cuda mats: 8, copies: h->d: 0, d->h: 3
2014-10-16 14:28:13: test at n-instances: 0
2014-10-16 14:28:15: pred. test+ dbn l0, rbm INPUTS rmse: 4.812d-1 (7840000)
2014-10-16 14:28:15: cuda mats: 10022, copies: h->d: 10003, d->h: 3
2014-10-16 14:28:15: ---------------------------------------------------
2014-10-16 14:28:34: training at n-instances: 60000
2014-10-16 14:28:34: train train+ rbm INPUTS rmse: 3.123d-1 (47040000)
2014-10-16 14:28:34: test at n-instances: 60000
2014-10-16 14:28:35: pred. test+ dbn l0, rbm INPUTS rmse: 1.190d-1 (7840000)
2014-10-16 14:28:35: cuda mats: 70030, copies: h->d: 70003, d->h: 3
2014-10-16 14:28:35: ---------------------------------------------------
2014-10-16 14:28:51: training at n-instances: 120000
2014-10-16 14:28:51: train train+ rbm INPUTS rmse: 2.567d-1 (47040000)
2014-10-16 14:28:51: test at n-instances: 120000
2014-10-16 14:28:53: pred. test+ dbn l0, rbm INPUTS rmse: 9.815d-2 (7840000)
2014-10-16 14:28:53: cuda mats: 70030, copies: h->d: 70003, d->h: 3
2014-10-16 14:28:53: ---------------------------------------------------
2014-10-16 14:28:53: Starting to train level 1 RBM in DBN.
2014-10-16 14:28:53: Describing gradient source:
#<MNIST-RBM-CD-LEARNER {1009948183}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-RBM/2 (C1 F1 LABEL) - (C2 F2)>
  MONITORS                   = (#<MONITOR #1=train #2=train+ #3=rbm F1 #4=rmse: 0.000e+0 (0)>..
  SPARSITY-GRADIENT-SOURCES  = NIL
  SPARSER                    = NIL
  VISIBLE-SAMPLING           = T
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = #<CLOSURE (LAMBDA (OPTIMIZER) :IN TRAIN-MNIST/2) {1043635E8B}>
  OPTIMIZER                  = #<MNIST-RBM-OPTIMIZER {10099469E3}>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = NIL

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = T
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = "#<error printing object>"

#<MNIST-RBM/2 {105CB40633}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C1 1(100/100)>
                    #<SIGMOID-CHUNK F1 500(100/100)>
                    #<SOFTMAX-LABEL-CHUNK LABEL 10(1/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C2 1(1/100)>
                   #<SIGMOID-CHUNK F2 1000(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>
            #<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>
            #<FULL-CLOUD (F1 F2) :NORM 7.07103d+0>
            #<FULL-CLOUD (LABEL C2) :NORM 0.00000d+0>
            #<FULL-CLOUD (LABEL F2) :NORM 9.97621d-1>)
  N-STRIPES = 100
  MAX-N-STRIPES = 100

RBM description:
  DBN = #<MNIST-DBN {10307DA463}>

2014-10-16 14:28:53: Describing optimizer:
#<MNIST-RBM-OPTIMIZER {10099469E3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (LABEL F2) :NORM 9.97621d-1>)
                    {100994AA63}>
                  {1009948B33}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (LABEL C2) :NORM 0.00000d+0>)
                    {100994A2D3}>
                  {1009948A43}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 F2) :NORM 7.07103d+0>)
                    {1009949B43}>
                  {1009948953}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>)
                    {10099493B3}>
                  {1009948863}>
                #<MNIST-RBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)
                    {1009948C23}>
                  {1009948773}>)
  SEGMENTS = (#<FULL-CLOUD (LABEL F2) :NORM 9.97621d-1>
              #<FULL-CLOUD (LABEL C2) :NORM 0.00000d+0>
              #<FULL-CLOUD (F1 F2) :NORM 7.07103d+0>
              #<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>
              #<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)

#<MNIST-RBM-SEGMENT-OPTIMIZER {1009948B33}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (LABEL F2) :NORM 9.97621d-1>)
                  {100994AA63}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 1.00000d-3
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {1009948A43}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (LABEL C2) :NORM 0.00000d+0>)
                  {100994A2D3}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {1009948953}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 F2) :NORM 7.07103d+0>)
                  {1009949B43}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 1.00000d-3
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {1009948863}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 C2) :NORM 0.00000d+0>)
                  {10099493B3}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-RBM-SEGMENT-OPTIMIZER {1009948773}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C1 F2) :NORM 0.00000d+0>)
                  {1009948C23}>
  LEARNING-RATE = 5.00000d-2
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:28:53: cuda mats: 70030, copies: h->d: 70003, d->h: 8
2014-10-16 14:28:53: test at n-instances: 0
2014-10-16 14:28:59: pred. train+ dbn l1, rbm LABEL  acc.: 9.40% (1000)
2014-10-16 14:28:59: pred. train+ dbn l1, rbm LABEL  xent: 2.296d-2 (1000)
2014-10-16 14:28:59: pred. train  dbn l1, rbm LABEL  acc.: 9.40% (1000)
2014-10-16 14:28:59: pred. train  dbn l1, rbm LABEL  xent: 2.318d-2 (1000)
2014-10-16 14:28:59: pred. test+  dbn l0, rbm INPUTS rmse: 3.306d-1 (7840000)
2014-10-16 14:28:59: pred. test+  dbn l1, rbm F1     rmse: 4.331d-1 (5000000)
2014-10-16 14:28:59: pred. test+  dbn l1, rbm LABEL  rmse: 2.999d-1 (100000)
2014-10-16 14:28:59: pred. test   dbn l1, rbm LABEL  acc.: 9.58% (10000)
2014-10-16 14:28:59: pred. test   dbn l1, rbm LABEL  xent: 2.321d-2 (10000)
2014-10-16 14:28:59: cuda mats: 70048, copies: h->d: 70224, d->h: 12570
2014-10-16 14:28:59: ---------------------------------------------------
2014-10-16 14:29:27: training at n-instances: 60000
2014-10-16 14:29:27: train train+ rbm F1    rmse: 4.536d-1 (30000000)
2014-10-16 14:29:27: train train+ rbm LABEL rmse: 2.562d-1 (600000)
2014-10-16 14:29:27: train train+ rbm LABEL acc.: 67.19% (60000)
2014-10-16 14:29:27: train train+ rbm LABEL xent: 1.133d-1 (60000)
2014-10-16 14:29:27: test at n-instances: 60000
2014-10-16 14:29:33: pred. train+ dbn l1, rbm LABEL  acc.: 91.30% (1000)
2014-10-16 14:29:33: pred. train+ dbn l1, rbm LABEL  xent: 2.887d-3 (1000)
2014-10-16 14:29:33: pred. train  dbn l1, rbm LABEL  acc.: 89.70% (1000)
2014-10-16 14:29:33: pred. train  dbn l1, rbm LABEL  xent: 3.590d-3 (1000)
2014-10-16 14:29:33: pred. test+  dbn l0, rbm INPUTS rmse: 1.190d-1 (7840000)
2014-10-16 14:29:33: pred. test+  dbn l1, rbm F1     rmse: 1.071d-1 (5000000)
2014-10-16 14:29:33: pred. test+  dbn l1, rbm LABEL  rmse: 1.061d-1 (100000)
2014-10-16 14:29:33: pred. test   dbn l1, rbm LABEL  acc.: 91.02% (10000)
2014-10-16 14:29:33: pred. test   dbn l1, rbm LABEL  xent: 3.266d-3 (10000)
2014-10-16 14:29:33: cuda mats: 70054, copies: h->d: 71044, d->h: 86333
2014-10-16 14:29:33: ---------------------------------------------------
2014-10-16 14:30:01: training at n-instances: 120000
2014-10-16 14:30:01: train train+ rbm F1    rmse: 3.968d-1 (30000000)
2014-10-16 14:30:01: train train+ rbm LABEL rmse: 1.849d-1 (600000)
2014-10-16 14:30:01: train train+ rbm LABEL acc.: 82.91% (60000)
2014-10-16 14:30:01: train train+ rbm LABEL xent: 5.903d-2 (60000)
2014-10-16 14:30:01: test at n-instances: 120000
2014-10-16 14:30:07: pred. train+ dbn l1, rbm LABEL  acc.: 94.20% (1000)
2014-10-16 14:30:07: pred. train+ dbn l1, rbm LABEL  xent: 2.120d-3 (1000)
2014-10-16 14:30:07: pred. train  dbn l1, rbm LABEL  acc.: 92.10% (1000)
2014-10-16 14:30:07: pred. train  dbn l1, rbm LABEL  xent: 2.784d-3 (1000)
2014-10-16 14:30:07: pred. test+  dbn l0, rbm INPUTS rmse: 1.150d-1 (7840000)
2014-10-16 14:30:07: pred. test+  dbn l1, rbm F1     rmse: 8.911d-2 (5000000)
2014-10-16 14:30:07: pred. test+  dbn l1, rbm LABEL  rmse: 8.815d-2 (100000)
2014-10-16 14:30:07: pred. test   dbn l1, rbm LABEL  acc.: 93.46% (10000)
2014-10-16 14:30:07: pred. test   dbn l1, rbm LABEL  xent: 2.523d-3 (10000)
2014-10-16 14:30:07: cuda mats: 70054, copies: h->d: 71864, d->h: 160096
2014-10-16 14:30:07: ---------------------------------------------------
2014-10-16 14:30:08: Starting to train DBM.
2014-10-16 14:30:08: Describing gradient source:
#<BM-PCD-LEARNER {1086657093}>
  [standard-object]

Slots with :INSTANCE allocation:
  BM                         = #<MNIST-DBM (C0 INPUTS LABEL) - (C1 F1 C2 F2)>
  MONITORS                   = (#<MONITOR #1=train #2=train+ #3=dbm INPUTS #4=rmse: 0.000e+0 (0)>..
  SPARSITY-GRADIENT-SOURCES  = (#<CHEATING-SPARSITY-GRADIENT-SOURCE (C0 F1) F1 {108667DD63}>..
  SPARSER                    = #<FUNCTION (LAMBDA (CLOUD CHUNK) :IN TRAIN-MNIST-DBM) {100AB5617B}>
  VISIBLE-SAMPLING           = T
  HIDDEN-SAMPLING            = :HALF-HEARTED
  N-GIBBS                    = 5
  N-PARTICLES                = 100
  PERSISTENT-CHAINS          = #<MNIST-DBM (C0 INPUTS LABEL) - (C1 F1 C2 F2)>

SPARSE-BM-LEARNER description:
  SPARSITY-GRADIENT-SOURCES = (#<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 (C0 F1) F1 {108667DD63}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 (INPUTS F1) F1 {108667F793}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 (C1 F2) F2 {1086770A23}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 (F1 C2) F1 {1086771C63}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE
                                 #1=(F1 F2) F1 {1086772E53}>
                               #<CHEATING-SPARSITY-GRADIENT-SOURCE #1#
                                 F2 {1086774043}>)

BM-MCMC-LEARNER description:
  VISIBLE-SAMPLING = T
  HIDDEN-SAMPLING = :HALF-HEARTED
  N-GIBBS = 5

BM-PCD-LEARNER description:
  N-PARTICLES = 100

#<MNIST-DBM {1062313B23}>
BM description:
  VISIBLE-CHUNKS = (#<CONSTANT-CHUNK C0 1(1/100)>
                    #<SIGMOID-CHUNK INPUTS 784(1/100)>
                    #<SOFTMAX-LABEL-CHUNK LABEL 10(1/100)>)
  HIDDEN-CHUNKS = (#<CONSTANT-CHUNK C1 1(1/100)>
                   #<SIGMOID-CHUNK F1 500(1/100)>
                   #<CONSTANT-CHUNK C2 1(1/100)>
                   #<SIGMOID-CHUNK F2 1000(1/100)>)
  CLOUDS = (#<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>
            #<FULL-CLOUD (INPUTS C1) :NORM 5.53860d+0>
            #<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>
            #<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>
            #<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>
            #<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>
            #<FULL-CLOUD (LABEL C2) :NORM 8.66429d-2>
            #<FULL-CLOUD (LABEL F2) :NORM 7.37013d+0>)
  N-STRIPES = 1
  MAX-N-STRIPES = 100

#<CHEATING-SPARSITY-GRADIENT-SOURCE {108667DD63}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>
  CHUNK = #<SIGMOID-CHUNK F1 500(1/100)>
  TARGET = 2.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {108667F793}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>
  CHUNK = #<SIGMOID-CHUNK F1 500(1/100)>
  TARGET = 2.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {10878DE9D3}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>
  CHUNK = #<SIGMOID-CHUNK F2 1000(1/100)>
  TARGET = 1.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {10878DE9F3}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>
  CHUNK = #<SIGMOID-CHUNK F1 500(1/100)>
  TARGET = 2.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {10878DEA13}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>
  CHUNK = #<SIGMOID-CHUNK F1 500(1/100)>
  TARGET = 2.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
#<CHEATING-SPARSITY-GRADIENT-SOURCE {10878DEA33}>
SPARSITY-GRADIENT-SOURCE description:
  CLOUD = #<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>
  CHUNK = #<SIGMOID-CHUNK F2 1000(1/100)>
  TARGET = 1.00000d-1
  COST = 1.00000d-3
  DAMPING = 9.00000d-1
2014-10-16 14:30:08: Describing optimizer:
#<MNIST-DBM-OPTIMIZER {10866556F3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (LABEL F2) :NORM 7.37013d+0>)
                    {108667CF63}>
                  {1086679983}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (LABEL C2) :NORM 8.66429d-2>)
                    {108667C7D3}>
                  {1086679893}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>)
                    {108667C043}>
                  {10866797A3}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>)
                    {108667B8B3}>
                  {10866796B3}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>)
                    {108667B123}>
                  {10866795C3}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>)
                    {108667A993}>
                  {10866794D3}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (INPUTS C1) :NORM 5.53860d+0>)
                    {108667A203}>
                  {10866793E3}>
                #<MNIST-DBM-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>)
                    {1086679A73}>
                  {10866792F3}>)
  SEGMENTS = (#<FULL-CLOUD (LABEL F2) :NORM 7.37013d+0>
              #<FULL-CLOUD (LABEL C2) :NORM 8.66429d-2>
              #<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>
              #<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>
              #<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>
              #<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>
              #<FULL-CLOUD (INPUTS C1) :NORM 5.53860d+0>
              #<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>)

#<MNIST-DBM-SEGMENT-OPTIMIZER {1086679983}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (LABEL F2) :NORM 7.37013d+0>)
                  {108667CF63}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {1086679893}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (LABEL C2) :NORM 8.66429d-2>)
                  {108667C7D3}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {10866797A3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 F2) :NORM 4.18160d+1>)
                  {108667C043}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {10866796B3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (F1 C2) :NORM 2.63970d+0>)
                  {108667B8B3}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {10866795C3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C1 F2) :NORM 9.35606d+0>)
                  {108667B123}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {10866794D3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS F1) :NORM 5.48217d+1>)
                  {108667A993}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 2.00000d-4
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {10866793E3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<FULL-CLOUD (INPUTS C1) :NORM 5.53860d+0>)
                  {108667A203}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-DBM-SEGMENT-OPTIMIZER {10866792F3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET (#<FULL-CLOUD (C0 F1) :NORM 1.91929d+1>)
                  {1086679A73}>
  LEARNING-RATE = 1.00000d-3
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:30:08: cuda mats: 136, copies: h->d: 106, d->h: 1
2014-10-16 14:30:08: test at n-instances: 0
2014-10-16 14:30:49: pred. train+ dbm LABEL acc.: 100.00% (1000)
2014-10-16 14:30:49: pred. train+ dbm LABEL xent: 0.000d+0 (1000)
2014-10-16 14:30:49: pred. train  dbm LABEL acc.: 9.70% (1000)
2014-10-16 14:30:49: pred. train  dbm LABEL xent: 3.454d-1 (1000)
2014-10-16 14:30:49: pred. test   dbm LABEL acc.: 9.80% (10000)
2014-10-16 14:30:49: pred. test   dbm LABEL xent: 3.454d-1 (10000)
2014-10-16 14:30:49: cuda mats: 11160, copies: h->d: 11230, d->h: 1233
2014-10-16 14:30:49: ---------------------------------------------------
2014-10-16 14:35:36: training at n-instances: 60000
2014-10-16 14:35:36: train train+ dbm INPUTS rmse: 1.659d-1 (47040000)
2014-10-16 14:35:36: train train+ dbm LABEL  rmse: 8.502d-2 (600000)
2014-10-16 14:35:36: train train+ dbm LABEL  acc.: 95.72% (60000)
2014-10-16 14:35:36: train train+ dbm LABEL  xent: 1.744d-3 (60000)
2014-10-16 14:35:36: test at n-instances: 60000
2014-10-16 14:36:12: pred. train+ dbm LABEL acc.: 100.00% (1000)
2014-10-16 14:36:12: pred. train+ dbm LABEL xent: 0.000d+0 (1000)
2014-10-16 14:36:12: pred. train  dbm LABEL acc.: 9.70% (1000)
2014-10-16 14:36:12: pred. train  dbm LABEL xent: 3.454d-1 (1000)
2014-10-16 14:36:12: pred. test   dbm LABEL acc.: 9.80% (10000)
2014-10-16 14:36:12: pred. test   dbm LABEL xent: 3.454d-1 (10000)
2014-10-16 14:36:12: cuda mats: 70110, copies: h->d: 70855, d->h: 63666
2014-10-16 14:36:12: ---------------------------------------------------
2014-10-16 14:36:13: inits:
((:CLOUD-NAME (C1 F2) :WEIGHT-NAME (:CLOUD (C1 F2)))
 (:CLOUD-NAME (F1 F2) :WEIGHT-NAME (:CLOUD (F1 F2)))
 (:CLOUD-NAME (C0 F1) :WEIGHT-NAME (:CLOUD (C0 F1)))
 (:CLOUD-NAME (INPUTS F1) :WEIGHT-NAME (:CLOUD (INPUTS F1)))
 (:CLOUD-NAME (F1 C2) :WEIGHT-NAME (:CLOUD (F1 C2) :TRANSPOSE))
 (:CLOUD-NAME (F1 F2) :WEIGHT-NAME (:CLOUD (F1 F2) :TRANSPOSE)))
2014-10-16 14:36:13: bpn def:
(BUILD-BPN (:CLASS 'MNIST-BPN/2 :MAX-N-STRIPES 1000 :INITARGS
            '(:POPULATE-KEY #<FUNCTION FIRST>
              :POPULATE-CONVERT-TO-DBM-SAMPLE-FN
              #<FUNCTION (LAMBDA (SAMPLE) :IN TRAIN-MNIST/2) {1048A2147B}>
              :POPULATE-MAP-CACHE-LAZILY-FROM-DBM
              #<MNIST-DBM (C0 INPUTS LABEL) - (C1 F1 C2 F2)>
              :POPULATE-PERIODIC-FN #<PERIODIC-FN {10698AE483}>))
  (#:G281561 (->INPUT :NAME '(:CHUNK F2 :MAP) :SIZE 1000))
  (#:G281560 (->CONSTANT :NAME '(:CHUNK C2 :MAP) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G281557 (->INPUT :NAME '(:CHUNK INPUTS) :SIZE 784))
  (#:G281555 (->CONSTANT :NAME '(:CHUNK C0) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G281558 (->CONSTANT :NAME '(:CHUNK C1) :SIZE 1 :DEFAULT-VALUE 1.0d0))
  (#:G281568 (->WEIGHT :NAME '(:CLOUD (F1 F2) :TRANSPOSE) :SIZE 500000))
  (#:G281569
   (->ACTIVATION :NAME '(:CLOUD (F1 F2) :TRANSPOSE :LINEAR) :SIZE 500 :WEIGHTS
                 #:G281568 :X #:G281561 :TRANSPOSE-WEIGHTS-P T))
  (#:G281570 (->WEIGHT :NAME '(:CLOUD (F1 C2) :TRANSPOSE) :SIZE 500))
  (#:G281571
   (->ACTIVATION :NAME '(:CLOUD (F1 C2) :TRANSPOSE :LINEAR) :SIZE 500 :WEIGHTS
                 #:G281570 :X #:G281560 :TRANSPOSE-WEIGHTS-P T))
  (#:G281572 (->WEIGHT :NAME '(:CLOUD (INPUTS F1)) :SIZE 392000))
  (#:G281573
   (->ACTIVATION :NAME '(:CLOUD (INPUTS F1) :LINEAR) :SIZE 500 :WEIGHTS
                 #:G281572 :X #:G281557 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G281574 (->WEIGHT :NAME '(:CLOUD (C0 F1)) :SIZE 500))
  (#:G281575
   (->ACTIVATION :NAME '(:CLOUD (C0 F1) :LINEAR) :SIZE 500 :WEIGHTS #:G281574
                 :X #:G281555 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G281567
   (->+ :NAME '(:CHUNK F1 :ACTIVATION) :ARGS
        (LIST #:G281569 #:G281571 #:G281573 #:G281575)))
  (#:G281556 (->SIGMOID :NAME '(:CHUNK F1) :X #:G281567))
  (#:G281577 (->WEIGHT :NAME '(:CLOUD (F1 F2)) :SIZE 500000))
  (#:G281578
   (->ACTIVATION :NAME '(:CLOUD (F1 F2) :LINEAR) :SIZE 1000 :WEIGHTS #:G281577
                 :X #:G281556 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G281579 (->WEIGHT :NAME '(:CLOUD (C1 F2)) :SIZE 1000))
  (#:G281580
   (->ACTIVATION :NAME '(:CLOUD (C1 F2) :LINEAR) :SIZE 1000 :WEIGHTS #:G281579
                 :X #:G281558 :TRANSPOSE-WEIGHTS-P NIL))
  (#:G281576
   (->+ :NAME '(:CHUNK F2 :ACTIVATION) :ARGS (LIST #:G281578 #:G281580)))
  (#:G281559 (->SIGMOID :NAME '(:CHUNK F2) :X #:G281576)))
2014-10-16 14:36:13: dropout #<->INPUT (:CHUNK INPUTS) :SIZE
                               784*1(1/100) :norm 0.00000> 0.2
2014-10-16 14:36:13: dropout #<->SIGMOID (:CHUNK F1) :SIZE
                               500*1(1/100) :norm 0.00000> 0.5
2014-10-16 14:36:13: dropout #<->SIGMOID (:CHUNK F2) :SIZE
                               1000*1(1/100) :norm 0.00000> 0.5
2014-10-16 14:36:13: Starting to train the whole BPN
2014-10-16 14:36:13: Describing gradient source:
#<BP-LEARNER {1074C5A693}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN/2 :N-STRIPES 1 :MAX-N-STRIPES 100 {1074A3CAD3}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = (#<MONITOR #1=train #2=train+ #3=bpn PREDICTIONS acc.: 0.00% (0)>..

BP-LEARNER description:
  BPN = #<MNIST-BPN/2 :N-STRIPES 1 :MAX-N-STRIPES 100 {1074A3CAD3}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN/2 {1074A3CAD3}>
BPN description:
  LUMPS = #(#<->INPUT (:CHUNK F2 :MAP) :SIZE
              1000*1(1/100) :norm 0.00000>
            #<->CONSTANT (:CHUNK C2 :MAP) :SIZE
              1*1(1/100) :norm 1.00000>
            #<->INPUT (:CHUNK INPUTS) :SIZE 784*1(1/100) :norm 0.00000>
            #<->CONSTANT (:CHUNK C0) :SIZE 1*1(1/100) :norm 1.00000>
            #<->CONSTANT (:CHUNK C1) :SIZE 1*1(1/100) :norm 1.00000>
            #<->WEIGHT (:CLOUD #1=(F1 F2) . #2=(:TRANSPOSE)) :SIZE
              500000*1(1/1) :norm 41.67080>
            #<->ACTIVATION (:CLOUD #1# :TRANSPOSE . #3=(:LINEAR)) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->WEIGHT (:CLOUD #4=(F1 C2) . #2#) :SIZE
              500*1(1/1) :norm 2.61410>
            #<->ACTIVATION (:CLOUD #4# :TRANSPOSE . #3#) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->WEIGHT (:CLOUD #5=(INPUTS F1)) :SIZE
              392000*1(1/1) :norm 68.66480>
            #<->ACTIVATION (:CLOUD #5# . #3#) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->WEIGHT (:CLOUD #6=(C0 F1)) :SIZE
              500*1(1/1) :norm 19.13846>
            #<->ACTIVATION (:CLOUD #6# . #3#) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->+ (:CHUNK F1 . #7=(:ACTIVATION)) :SIZE
              500*1(1/100) :norm 0.00000>
            #<->SIGMOID (:CHUNK F1) :SIZE 500*1(1/100) :norm 0.00000>
            #<->WEIGHT (:CLOUD #1#) :SIZE 500000*1(1/1) :norm 83.34160>
            #<->ACTIVATION (:CLOUD #1# . #3#) :SIZE
              1000*1(1/100) :norm 0.00000>
            #<->WEIGHT (:CLOUD #8=(C1 F2)) :SIZE
              1000*1(1/1) :norm 9.38955>
            #<->ACTIVATION (:CLOUD #8# . #3#) :SIZE
              1000*1(1/100) :norm 0.00000>
            #<->+ (:CHUNK F2 . #7#) :SIZE 1000*1(1/100) :norm 0.00000>
            #<->SIGMOID #9=(:CHUNK F2) :SIZE
              1000*1(1/100) :norm 0.00000>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.08687>
            #<->WEIGHT #10=(#9# PREDICTIONS) :SIZE
              10000*1(1/1) :norm 14.84943>
            #<->ACTIVATION (#10# :ACTIVATION) :SIZE
              10*1(1/100) :norm 0.00000>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1(1/100) :norm 0.00000>
            #<->INPUT EXPECTATIONS :SIZE 10*1(1/100) :norm 0.00000>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1(1/100) :norm 0.00000>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1(1/100) :norm 0.00000>)
  N-STRIPES = 1
  MAX-N-STRIPES = 100
2014-10-16 14:36:13: Describing optimizer:
#<MNIST-BPN-GD-OPTIMIZER {1074C57D43}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT ((:CHUNK F2) PREDICTIONS) :SIZE
                       10000*1(1/1) :norm 14.84943>)
                    {1074C5EAB3}>
                  {1074C5B4C3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                       10*1(1/1) :norm 0.08687>)
                    {1074C5E323}>
                  {1074C5B3A3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (C1 F2)) :SIZE
                       1000*1(1/1) :norm 9.38955>)
                    {1074C5DB93}>
                  {1074C5B283}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD #1=(F1 F2)) :SIZE
                       500000*1(1/1) :norm 83.34160>)
                    {1074C5D403}>
                  {1074C5B163}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (C0 F1)) :SIZE
                       500*1(1/1) :norm 19.13846>)
                    {1074C5CC73}>
                  {1074C5B043}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (INPUTS F1)) :SIZE
                       392000*1(1/1) :norm 68.66480>)
                    {1074C5C4E3}>
                  {1074C5AF23}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD (F1 C2) . #2=(:TRANSPOSE))
                       :SIZE 500*1(1/1) :norm 2.61410>)
                    {1074C5BD53}>
                  {1074C5AE03}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:CLOUD #1# . #2#) :SIZE
                       500000*1(1/1) :norm 41.67080>)
                    {1074C5B5C3}>
                  {1074C5ACE3}>)
  SEGMENTS = (#<->WEIGHT ((:CHUNK F2) PREDICTIONS) :SIZE
                10000*1(1/1) :norm 14.84943>
              #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                10*1(1/1) :norm 0.08687>
              #<->WEIGHT (:CLOUD (C1 F2)) :SIZE
                1000*1(1/1) :norm 9.38955>
              #<->WEIGHT (:CLOUD #1=(F1 F2)) :SIZE
                500000*1(1/1) :norm 83.34160>
              #<->WEIGHT (:CLOUD (C0 F1)) :SIZE
                500*1(1/1) :norm 19.13846>
              #<->WEIGHT (:CLOUD (INPUTS F1)) :SIZE
                392000*1(1/1) :norm 68.66480>
              #<->WEIGHT (:CLOUD (F1 C2) . #2=(:TRANSPOSE)) :SIZE
                500*1(1/1) :norm 2.61410>
              #<->WEIGHT (:CLOUD #1# . #2#) :SIZE
                500000*1(1/1) :norm 41.67080>)

#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1074C5B4C3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT ((:CHUNK F2) PREDICTIONS) :SIZE
                     10000*1(1/1) :norm 14.84943>)
                  {1074C5EAB3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1074C5B3A3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.08687>)
                  {1074C5E323}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1074C5B283}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (C1 F2)) :SIZE
                     1000*1(1/1) :norm 9.38955>)
                  {1074C5DB93}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1074C5B163}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (F1 F2)) :SIZE
                     500000*1(1/1) :norm 83.34160>)
                  {1074C5D403}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1074C5B043}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (C0 F1)) :SIZE
                     500*1(1/1) :norm 19.13846>)
                  {1074C5CC73}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1074C5AF23}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (INPUTS F1)) :SIZE
                     392000*1(1/1) :norm 68.66480>)
                  {1074C5C4E3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1074C5AE03}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (F1 C2) :TRANSPOSE) :SIZE
                     500*1(1/1) :norm 2.61410>)
                  {1074C5BD53}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1074C5ACE3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:CLOUD (F1 F2) :TRANSPOSE) :SIZE
                     500000*1(1/1) :norm 41.67080>)
                  {1074C5B5C3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 0
  BATCH-SIZE = 100
2014-10-16 14:36:13: cuda mats: 16, copies: h->d: 7, d->h: 8
2014-10-16 14:36:13: test at n-instances: 0
2014-10-16 14:36:13: populated: 0
2014-10-16 14:36:17: populated: 1000
2014-10-16 14:36:20: populated: 2000
2014-10-16 14:36:23: populated: 3000
2014-10-16 14:36:27: populated: 4000
2014-10-16 14:36:30: populated: 5000
2014-10-16 14:36:33: populated: 6000
2014-10-16 14:36:37: populated: 7000
2014-10-16 14:36:40: populated: 8000
2014-10-16 14:36:43: populated: 9000
2014-10-16 14:36:47: populated: 10000
2014-10-16 14:36:47: pred. test bpn PREDICTIONS acc.: 93.76% (10000)
2014-10-16 14:36:47: pred. test bpn PREDICTIONS xent: 2.464d-3 (10000)
2014-10-16 14:36:47: cuda mats: 20060, copies: h->d: 10223, d->h: 408
2014-10-16 14:36:47: ---------------------------------------------------
2014-10-16 14:36:50: populated: 11000
2014-10-16 14:36:54: populated: 12000
2014-10-16 14:36:58: populated: 13000
2014-10-16 14:37:02: populated: 14000
2014-10-16 14:37:05: populated: 15000
2014-10-16 14:37:09: populated: 16000
2014-10-16 14:37:13: populated: 17000
2014-10-16 14:37:17: populated: 18000
2014-10-16 14:37:20: populated: 19000
2014-10-16 14:37:24: populated: 20000
2014-10-16 14:37:28: populated: 21000
2014-10-16 14:37:31: populated: 22000
2014-10-16 14:37:35: populated: 23000
2014-10-16 14:37:39: populated: 24000
2014-10-16 14:37:43: populated: 25000
2014-10-16 14:37:46: populated: 26000
2014-10-16 14:37:50: populated: 27000
2014-10-16 14:37:54: populated: 28000
2014-10-16 14:37:58: populated: 29000
2014-10-16 14:38:01: populated: 30000
2014-10-16 14:38:05: populated: 31000
2014-10-16 14:38:09: populated: 32000
2014-10-16 14:38:13: populated: 33000
2014-10-16 14:38:17: populated: 34000
2014-10-16 14:38:20: populated: 35000
2014-10-16 14:38:24: populated: 36000
2014-10-16 14:38:28: populated: 37000
2014-10-16 14:38:32: populated: 38000
2014-10-16 14:38:35: populated: 39000
2014-10-16 14:38:39: populated: 40000
2014-10-16 14:38:43: populated: 41000
2014-10-16 14:38:47: populated: 42000
2014-10-16 14:38:50: populated: 43000
2014-10-16 14:38:54: populated: 44000
2014-10-16 14:38:58: populated: 45000
2014-10-16 14:39:02: populated: 46000
2014-10-16 14:39:05: populated: 47000
2014-10-16 14:39:09: populated: 48000
2014-10-16 14:39:13: populated: 49000
2014-10-16 14:39:17: populated: 50000
2014-10-16 14:39:20: populated: 51000
2014-10-16 14:39:24: populated: 52000
2014-10-16 14:39:28: populated: 53000
2014-10-16 14:39:31: populated: 54000
2014-10-16 14:39:35: populated: 55000
2014-10-16 14:39:39: populated: 56000
2014-10-16 14:39:43: populated: 57000
2014-10-16 14:39:46: populated: 58000
2014-10-16 14:39:50: populated: 59000
2014-10-16 14:39:54: populated: 60000
2014-10-16 14:39:58: populated: 61000
2014-10-16 14:40:02: populated: 62000
2014-10-16 14:40:05: populated: 63000
2014-10-16 14:40:09: populated: 64000
2014-10-16 14:40:13: populated: 65000
2014-10-16 14:40:16: populated: 66000
2014-10-16 14:40:20: populated: 67000
2014-10-16 14:40:24: populated: 68000
2014-10-16 14:40:28: populated: 69000
2014-10-16 14:40:31: populated: 70000
2014-10-16 14:40:31: training at n-instances: 60000
2014-10-16 14:40:31: train train+ bpn PREDICTIONS acc.: 90.19% (60000)
2014-10-16 14:40:31: train train+ bpn PREDICTIONS xent: 3.186d-3 (60000)
2014-10-16 14:40:31: test at n-instances: 60000
2014-10-16 14:40:34: pred. test bpn PREDICTIONS acc.: 95.32% (10000)
2014-10-16 14:40:34: pred. test bpn PREDICTIONS xent: 1.676d-3 (10000)
2014-10-16 14:40:34: cuda mats: 140107, copies: h->d: 71523, d->h: 3608
2014-10-16 14:40:34: ---------------------------------------------------
2014-10-16 14:41:11: training at n-instances: 120000
2014-10-16 14:41:11: train train+ bpn PREDICTIONS acc.: 92.25% (60000)
2014-10-16 14:41:11: train train+ bpn PREDICTIONS xent: 2.542d-3 (60000)
2014-10-16 14:41:11: test at n-instances: 120000
2014-10-16 14:41:13: pred. test bpn PREDICTIONS acc.: 95.70% (10000)
2014-10-16 14:41:13: pred. test bpn PREDICTIONS xent: 1.486d-3 (10000)
2014-10-16 14:41:13: cuda mats: 140107, copies: h->d: 72223, d->h: 5608
2014-10-16 14:41:13: ---------------------------------------------------
2014-10-16 14:41:18: TRAIN-MNIST/3
2014-10-16 14:41:18: Starting to train the whole BPN
2014-10-16 14:41:18: Describing gradient source:
#<BP-LEARNER {1010E66C93}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 96 {10105F4843}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = (#<MONITOR #1=train #2=train+ #3=bpn PREDICTIONS acc.: 0.00% (0)>..

BP-LEARNER description:
  BPN = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 96 {10105F4843}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN {10105F4843}>
BPN description:
  LUMPS = #(#<->INPUT INPUTS :SIZE 784*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS F1) :SIZE 1200*1(1/1) :norm 0.35523>
            #<->WEIGHT #1=(INPUTS F1) :SIZE
              940800*1(1/1) :norm 9.69657>
            #<->ACTIVATION (#1# :ACTIVATION) :SIZE
              1200*1(1/96) :norm 0.00000>
            #<->+ (F1 :ACTIVATION) :SIZE 1200*1(1/96) :norm 0.00000>
            #<->RECTIFIED F1* :SIZE 1200*1(1/96) :norm 0.00000>
            #<->DROPOUT F1 :SIZE 1200*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS F2) :SIZE 1200*1(1/1) :norm 0.33265>
            #<->WEIGHT #2=(F1 F2) :SIZE 1440000*1(1/1) :norm 11.98457>
            #<->ACTIVATION (#2# :ACTIVATION) :SIZE
              1200*1(1/96) :norm 0.00000>
            #<->+ (F2 :ACTIVATION) :SIZE 1200*1(1/96) :norm 0.00000>
            #<->RECTIFIED F2* :SIZE 1200*1(1/96) :norm 0.00000>
            #<->DROPOUT F2 :SIZE 1200*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS F3) :SIZE 1200*1(1/1) :norm 0.34220>
            #<->WEIGHT #3=(F2 F3) :SIZE 1440000*1(1/1) :norm 11.98193>
            #<->ACTIVATION (#3# :ACTIVATION) :SIZE
              1200*1(1/96) :norm 0.00000>
            #<->+ (F3 :ACTIVATION) :SIZE 1200*1(1/96) :norm 0.00000>
            #<->RECTIFIED F3* :SIZE 1200*1(1/96) :norm 0.00000>
            #<->DROPOUT F3 :SIZE 1200*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.03284>
            #<->WEIGHT #4=(F3 PREDICTIONS) :SIZE
              12000*1(1/1) :norm 1.09774>
            #<->ACTIVATION (#4# :ACTIVATION) :SIZE
              10*1(1/96) :norm 0.00000>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1(1/96) :norm 0.00000>
            #<->INPUT EXPECTATIONS :SIZE 10*1(1/96) :norm 0.00000>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1(1/96) :norm 0.00000>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1(1/96) :norm 0.00000>)
  N-STRIPES = 1
  MAX-N-STRIPES = 96
2014-10-16 14:41:18: Describing optimizer:
#<MNIST-BPN-GD-OPTIMIZER {1010E63A43}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (F3 PREDICTIONS) :SIZE
                       12000*1(1/1) :norm 1.09774>
                     #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                       10*1(1/1) :norm 0.03284>)
                    {1010E69DE3}>
                  {1010E67DE3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (F2 F3) :SIZE
                       1440000*1(1/1) :norm 11.98193>
                     #<->WEIGHT (:BIAS F3) :SIZE
                       1200*1(1/1) :norm 0.34220>)
                    {1010E69633}>
                  {1010E67C43}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (F1 F2) :SIZE
                       1440000*1(1/1) :norm 11.98457>
                     #<->WEIGHT (:BIAS F2) :SIZE
                       1200*1(1/1) :norm 0.33265>)
                    {1010E68E83}>
                  {1010E67AA3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (INPUTS F1) :SIZE
                       940800*1(1/1) :norm 9.69657>)
                    {1010E686F3}>
                  {1010E67913}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:BIAS F1) :SIZE
                       1200*1(1/1) :norm 0.35523>)
                    {1010E67F63}>
                  {1010E67303}>)
  SEGMENTS = (#<->WEIGHT (F3 PREDICTIONS) :SIZE
                12000*1(1/1) :norm 1.09774>
              #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                10*1(1/1) :norm 0.03284>
              #<->WEIGHT (F2 F3) :SIZE 1440000*1(1/1) :norm 11.98193>
              #<->WEIGHT (:BIAS F3) :SIZE 1200*1(1/1) :norm 0.34220>
              #<->WEIGHT (F1 F2) :SIZE 1440000*1(1/1) :norm 11.98457>
              #<->WEIGHT (:BIAS F2) :SIZE 1200*1(1/1) :norm 0.33265>
              #<->WEIGHT (INPUTS F1) :SIZE 940800*1(1/1) :norm 9.69657>
              #<->WEIGHT (:BIAS F1) :SIZE 1200*1(1/1) :norm 0.35523>)

#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1010E67DE3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (F3 PREDICTIONS) :SIZE
                     12000*1(1/1) :norm 1.09774>
                   #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.03284>)
                  {1010E69DE3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1010E67C43}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (F2 F3) :SIZE
                     1440000*1(1/1) :norm 11.98193>
                   #<->WEIGHT (:BIAS F3) :SIZE
                     1200*1(1/1) :norm 0.34220>)
                  {1010E69633}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1010E67AA3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (F1 F2) :SIZE
                     1440000*1(1/1) :norm 11.98457>
                   #<->WEIGHT (:BIAS F2) :SIZE
                     1200*1(1/1) :norm 0.33265>)
                  {1010E68E83}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1010E67913}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (INPUTS F1) :SIZE
                     940800*1(1/1) :norm 9.69657>)
                  {1010E686F3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 10.00000d-7
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1010E67303}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:BIAS F1) :SIZE
                     1200*1(1/1) :norm 0.35523>)
                  {1010E67F63}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
2014-10-16 14:41:18: cuda mats: 9, copies: h->d: 0, d->h: 8
2014-10-16 14:41:18: test at n-instances: 0
2014-10-16 14:41:22: pred. test bpn PREDICTIONS acc.: 11.35% (10000)
2014-10-16 14:41:22: pred. test bpn PREDICTIONS xent: 2.417d-2 (10000)
2014-10-16 14:41:22: cuda mats: 10036, copies: h->d: 10110, d->h: 218
2014-10-16 14:41:22: ---------------------------------------------------
2014-10-16 14:43:05: training at n-instances: 60000
2014-10-16 14:43:05: train train+ bpn PREDICTIONS acc.: 51.22% (60000)
2014-10-16 14:43:05: train train+ bpn PREDICTIONS xent: 1.378d-2 (60000)
2014-10-16 14:43:05: test at n-instances: 60000
2014-10-16 14:43:09: pred. test bpn PREDICTIONS acc.: 93.27% (10000)
2014-10-16 14:43:09: pred. test bpn PREDICTIONS xent: 2.475d-3 (10000)
2014-10-16 14:43:09: cuda mats: 70079, copies: h->d: 70840, d->h: 2303
2014-10-16 14:43:09: ---------------------------------------------------
2014-10-16 14:44:49: training at n-instances: 120000
2014-10-16 14:44:49: train train+ bpn PREDICTIONS acc.: 92.01% (60000)
2014-10-16 14:44:49: train train+ bpn PREDICTIONS xent: 2.749d-3 (60000)
2014-10-16 14:44:49: test at n-instances: 120000
2014-10-16 14:44:53: pred. test bpn PREDICTIONS acc.: 95.85% (10000)
2014-10-16 14:44:53: pred. test bpn PREDICTIONS xent: 1.434d-3 (10000)
2014-10-16 14:44:53: cuda mats: 70087, copies: h->d: 71570, d->h: 4388
2014-10-16 14:44:53: ---------------------------------------------------
2014-10-16 14:44:54: TRAIN-MNIST/4
2014-10-16 14:44:54: Starting to train the whole BPN
2014-10-16 14:44:54: Describing gradient source:
#<BP-LEARNER {1003411EC3}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 96 {10033EA773}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = (#<MONITOR #1=train #2=train+ #3=bpn PREDICTIONS acc.: 0.00% (0)>..

BP-LEARNER description:
  BPN = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 96 {10033EA773}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN {10033EA773}>
BPN description:
  LUMPS = #(#<->INPUT INPUTS :SIZE 784*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS F1) :SIZE 1200*1(1/1) :norm 0.35523>
            #<->WEIGHT #1=(INPUTS F1) :SIZE
              940800*1(1/1) :norm 9.69657>
            #<->ACTIVATION (#1# :ACTIVATION) :SIZE
              1200*1(1/96) :norm 0.00000>
            #<->+ (F1 :ACTIVATION) :SIZE 1200*1(1/96) :norm 0.00000>
            #<->MAX F1* :SIZE 240*1(1/96) :norm 0.00000>
            #<->DROPOUT F1 :SIZE 240*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS F2) :SIZE 1200*1(1/1) :norm 0.33265>
            #<->WEIGHT #2=(F1 F2) :SIZE 288000*1(1/1) :norm 5.34213>
            #<->ACTIVATION (#2# :ACTIVATION) :SIZE
              1200*1(1/96) :norm 0.00000>
            #<->+ (F2 :ACTIVATION) :SIZE 1200*1(1/96) :norm 0.00000>
            #<->MAX F2* :SIZE 240*1(1/96) :norm 0.00000>
            #<->DROPOUT F2 :SIZE 240*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.02431>
            #<->WEIGHT #3=(F2 PREDICTIONS) :SIZE
              2400*1(1/1) :norm 0.49172>
            #<->ACTIVATION (#3# :ACTIVATION) :SIZE
              10*1(1/96) :norm 0.00000>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1(1/96) :norm 0.00000>
            #<->INPUT EXPECTATIONS :SIZE 10*1(1/96) :norm 0.00000>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1(1/96) :norm 0.00000>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1(1/96) :norm 0.00000>)
  N-STRIPES = 1
  MAX-N-STRIPES = 96
2014-10-16 14:44:54: Describing optimizer:
#<MNIST-BPN-GD-OPTIMIZER {100340F7E3}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (F2 PREDICTIONS) :SIZE
                       2400*1(1/1) :norm 0.49172>
                     #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                       10*1(1/1) :norm 0.02431>)
                    {1003414213}>
                  {10034129C3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (F1 F2) :SIZE
                       288000*1(1/1) :norm 5.34213>
                     #<->WEIGHT (:BIAS F2) :SIZE
                       1200*1(1/1) :norm 0.33265>)
                    {1003413A63}>
                  {1003412823}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (INPUTS F1) :SIZE
                       940800*1(1/1) :norm 9.69657>)
                    {10034132D3}>
                  {1003412693}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:BIAS F1) :SIZE
                       1200*1(1/1) :norm 0.35523>)
                    {1003412B43}>
                  {10034124F3}>)
  SEGMENTS = (#<->WEIGHT (F2 PREDICTIONS) :SIZE
                2400*1(1/1) :norm 0.49172>
              #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                10*1(1/1) :norm 0.02431>
              #<->WEIGHT (F1 F2) :SIZE 288000*1(1/1) :norm 5.34213>
              #<->WEIGHT (:BIAS F2) :SIZE 1200*1(1/1) :norm 0.33265>
              #<->WEIGHT (INPUTS F1) :SIZE 940800*1(1/1) :norm 9.69657>
              #<->WEIGHT (:BIAS F1) :SIZE 1200*1(1/1) :norm 0.35523>)

#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {10034129C3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (F2 PREDICTIONS) :SIZE
                     2400*1(1/1) :norm 0.49172>
                   #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.02431>)
                  {1003414213}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1003412823}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (F1 F2) :SIZE
                     288000*1(1/1) :norm 5.34213>
                   #<->WEIGHT (:BIAS F2) :SIZE
                     1200*1(1/1) :norm 0.33265>)
                  {1003413A63}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {1003412693}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (INPUTS F1) :SIZE
                     940800*1(1/1) :norm 9.69657>)
                  {10034132D3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 10.00000d-7
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {10034124F3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:BIAS F1) :SIZE
                     1200*1(1/1) :norm 0.35523>)
                  {1003412B43}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
2014-10-16 14:44:54: cuda mats: 7, copies: h->d: 0, d->h: 6
2014-10-16 14:44:54: test at n-instances: 0
2014-10-16 14:44:56: pred. test bpn PREDICTIONS acc.: 10.09% (10000)
2014-10-16 14:44:56: pred. test bpn PREDICTIONS xent: 2.418d-2 (10000)
2014-10-16 14:44:56: cuda mats: 10028, copies: h->d: 10109, d->h: 216
2014-10-16 14:44:56: ---------------------------------------------------
2014-10-16 14:45:33: training at n-instances: 60000
2014-10-16 14:45:33: train train+ bpn PREDICTIONS acc.: 72.13% (60000)
2014-10-16 14:45:33: train train+ bpn PREDICTIONS xent: 8.367d-3 (60000)
2014-10-16 14:45:33: test at n-instances: 60000
2014-10-16 14:45:34: pred. test bpn PREDICTIONS acc.: 95.35% (10000)
2014-10-16 14:45:34: pred. test bpn PREDICTIONS xent: 1.642d-3 (10000)
2014-10-16 14:45:34: cuda mats: 70068, copies: h->d: 70842, d->h: 2301
2014-10-16 14:45:34: ---------------------------------------------------
2014-10-16 14:46:09: training at n-instances: 120000
2014-10-16 14:46:09: train train+ bpn PREDICTIONS acc.: 93.52% (60000)
2014-10-16 14:46:09: train train+ bpn PREDICTIONS xent: 2.246d-3 (60000)
2014-10-16 14:46:09: test at n-instances: 120000
2014-10-16 14:46:11: pred. test bpn PREDICTIONS acc.: 96.39% (10000)
2014-10-16 14:46:11: pred. test bpn PREDICTIONS xent: 1.213d-3 (10000)
2014-10-16 14:46:11: cuda mats: 70062, copies: h->d: 71572, d->h: 4386
2014-10-16 14:46:11: ---------------------------------------------------
2014-10-16 14:46:12: TRAIN-MNIST/5
2014-10-16 14:46:12: Starting to train the whole BPN
2014-10-16 14:46:12: Describing gradient source:
#<BP-LEARNER {10A2B279E3}>
  [standard-object]

Slots with :INSTANCE allocation:
  BPN                 = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 96 {10A2AFB083}>
  FIRST-TRAINED-LUMP  = NIL
  MONITORS            = (#<MONITOR #1=train #2=train+ #3=bpn PREDICTIONS acc.: 0.00% (0)>..

BP-LEARNER description:
  BPN = #<MNIST-BPN :N-STRIPES 1 :MAX-N-STRIPES 96 {10A2AFB083}>
  FIRST-TRAINED-LUMP = NIL
#<MNIST-BPN {10A2AFB083}>
BPN description:
  LUMPS = #(#<->INPUT INPUTS :SIZE 784*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS F1) :SIZE 1200*1(1/1) :norm 0.35523>
            #<->WEIGHT #1=(INPUTS F1) :SIZE
              940800*1(1/1) :norm 9.69657>
            #<->ACTIVATION (#1# :ACTIVATION) :SIZE
              1200*1(1/96) :norm 0.00000>
            #<->+ (F1 :ACTIVATION) :SIZE 1200*1(1/96) :norm 0.00000>
            #<->MAX-CHANNEL F1* :SIZE 1200*1(1/96) :norm 0.00000>
            #<->DROPOUT F1 :SIZE 1200*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS F2) :SIZE 1200*1(1/1) :norm 0.33265>
            #<->WEIGHT #2=(F1 F2) :SIZE 1440000*1(1/1) :norm 11.98457>
            #<->ACTIVATION (#2# :ACTIVATION) :SIZE
              1200*1(1/96) :norm 0.00000>
            #<->+ (F2 :ACTIVATION) :SIZE 1200*1(1/96) :norm 0.00000>
            #<->MAX-CHANNEL F2* :SIZE 1200*1(1/96) :norm 0.00000>
            #<->DROPOUT F2 :SIZE 1200*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS F3) :SIZE 1200*1(1/1) :norm 0.34220>
            #<->WEIGHT #3=(F2 F3) :SIZE 1440000*1(1/1) :norm 11.98193>
            #<->ACTIVATION (#3# :ACTIVATION) :SIZE
              1200*1(1/96) :norm 0.00000>
            #<->+ (F3 :ACTIVATION) :SIZE 1200*1(1/96) :norm 0.00000>
            #<->MAX-CHANNEL F3* :SIZE 1200*1(1/96) :norm 0.00000>
            #<->DROPOUT F3 :SIZE 1200*1(1/96) :norm 0.00000>
            #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
              10*1(1/1) :norm 0.03284>
            #<->WEIGHT #4=(F3 PREDICTIONS) :SIZE
              12000*1(1/1) :norm 1.09774>
            #<->ACTIVATION (#4# :ACTIVATION) :SIZE
              10*1(1/96) :norm 0.00000>
            #<->+ (PREDICTIONS :ACTIVATION) :SIZE
              10*1(1/96) :norm 0.00000>
            #<->INPUT EXPECTATIONS :SIZE 10*1(1/96) :norm 0.00000>
            #<->CROSS-ENTROPY-SOFTMAX PREDICTIONS :SIZE
              10*1(1/96) :norm 0.00000>
            #<->ERROR (PREDICTIONS :ERROR) :SIZE
              1*1(1/96) :norm 0.00000>)
  N-STRIPES = 1
  MAX-N-STRIPES = 96
2014-10-16 14:46:12: Describing optimizer:
#<MNIST-BPN-GD-OPTIMIZER {10A2B24D13}>
SEGMENTED-GD-OPTIMIZER description:
  N-INSTANCES = 0
  OPTIMIZERS = (#<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (F3 PREDICTIONS) :SIZE
                       12000*1(1/1) :norm 1.09774>
                     #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                       10*1(1/1) :norm 0.03284>)
                    {10A2C1A753}>
                  {10A2C18753}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (F2 F3) :SIZE
                       1440000*1(1/1) :norm 11.98193>
                     #<->WEIGHT (:BIAS F3) :SIZE
                       1200*1(1/1) :norm 0.34220>)
                    {10A2C19FA3}>
                  {10A2C185B3}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (F1 F2) :SIZE
                       1440000*1(1/1) :norm 11.98457>
                     #<->WEIGHT (:BIAS F2) :SIZE
                       1200*1(1/1) :norm 0.33265>)
                    {10A2C197F3}>
                  {10A2C18413}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (INPUTS F1) :SIZE
                       940800*1(1/1) :norm 9.69657>)
                    {10A2C19063}>
                  {10A2C18283}>
                #<MNIST-BPN-GD-SEGMENT-OPTIMIZER
                  #<SEGMENT-SET
                    (#<->WEIGHT (:BIAS F1) :SIZE
                       1200*1(1/1) :norm 0.35523>)
                    {10A2C188D3}>
                  {10A2C180E3}>)
  SEGMENTS = (#<->WEIGHT (F3 PREDICTIONS) :SIZE
                12000*1(1/1) :norm 1.09774>
              #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                10*1(1/1) :norm 0.03284>
              #<->WEIGHT (F2 F3) :SIZE 1440000*1(1/1) :norm 11.98193>
              #<->WEIGHT (:BIAS F3) :SIZE 1200*1(1/1) :norm 0.34220>
              #<->WEIGHT (F1 F2) :SIZE 1440000*1(1/1) :norm 11.98457>
              #<->WEIGHT (:BIAS F2) :SIZE 1200*1(1/1) :norm 0.33265>
              #<->WEIGHT (INPUTS F1) :SIZE 940800*1(1/1) :norm 9.69657>
              #<->WEIGHT (:BIAS F1) :SIZE 1200*1(1/1) :norm 0.35523>)

#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {10A2C18753}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (F3 PREDICTIONS) :SIZE
                     12000*1(1/1) :norm 1.09774>
                   #<->WEIGHT (:BIAS PREDICTIONS) :SIZE
                     10*1(1/1) :norm 0.03284>)
                  {10A2C1A753}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {10A2C185B3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (F2 F3) :SIZE
                     1440000*1(1/1) :norm 11.98193>
                   #<->WEIGHT (:BIAS F3) :SIZE
                     1200*1(1/1) :norm 0.34220>)
                  {10A2C19FA3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {10A2C18413}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (F1 F2) :SIZE
                     1440000*1(1/1) :norm 11.98457>
                   #<->WEIGHT (:BIAS F2) :SIZE
                     1200*1(1/1) :norm 0.33265>)
                  {10A2C197F3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {10A2C18283}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (INPUTS F1) :SIZE
                     940800*1(1/1) :norm 9.69657>)
                  {10A2C19063}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 10.00000d-7
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
#<MNIST-BPN-GD-SEGMENT-OPTIMIZER {10A2C180E3}>
GD-OPTIMIZER description:
  N-INSTANCES = 0
  SEGMENT-SET = #<SEGMENT-SET
                  (#<->WEIGHT (:BIAS F1) :SIZE
                     1200*1(1/1) :norm 0.35523>)
                  {10A2C188D3}>
  LEARNING-RATE = 5.00000d-1
  MOMENTUM = 5.00000d-1
  MOMENTUM-TYPE = :NORMAL
  WEIGHT-DECAY = 0.00000d+0
  WEIGHT-PENALTY = 0.00000d+0
  N-AFTER-UPATE-HOOK = 1
  BATCH-SIZE = 96
2014-10-16 14:46:12: cuda mats: 9, copies: h->d: 0, d->h: 8
2014-10-16 14:46:12: test at n-instances: 0
2014-10-16 14:46:16: pred. test bpn PREDICTIONS acc.: 11.35% (10000)
2014-10-16 14:46:16: pred. test bpn PREDICTIONS xent: 2.417d-2 (10000)
2014-10-16 14:46:16: cuda mats: 10036, copies: h->d: 10110, d->h: 218
2014-10-16 14:46:16: ---------------------------------------------------
2014-10-16 14:47:59: training at n-instances: 60000
2014-10-16 14:47:59: train train+ bpn PREDICTIONS acc.: 49.07% (60000)
2014-10-16 14:47:59: train train+ bpn PREDICTIONS xent: 1.440d-2 (60000)
2014-10-16 14:47:59: test at n-instances: 60000
2014-10-16 14:48:03: pred. test bpn PREDICTIONS acc.: 91.75% (10000)
2014-10-16 14:48:03: pred. test bpn PREDICTIONS xent: 2.925d-3 (10000)
2014-10-16 14:48:03: cuda mats: 70079, copies: h->d: 70843, d->h: 2303
2014-10-16 14:48:03: ---------------------------------------------------
2014-10-16 14:49:44: training at n-instances: 120000
2014-10-16 14:49:44: train train+ bpn PREDICTIONS acc.: 90.43% (60000)
2014-10-16 14:49:44: train train+ bpn PREDICTIONS xent: 3.299d-3 (60000)
2014-10-16 14:49:44: test at n-instances: 120000
2014-10-16 14:49:48: pred. test bpn PREDICTIONS acc.: 94.88% (10000)
2014-10-16 14:49:48: pred. test bpn PREDICTIONS xent: 1.766d-3 (10000)
2014-10-16 14:49:48: cuda mats: 70079, copies: h->d: 71573, d->h: 4388
2014-10-16 14:49:48: ---------------------------------------------------
